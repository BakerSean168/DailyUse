# DailyUse 项目 pnpm 配置优化

# ============================================================
# 镜像配置 - 使用阿里云 npm 镜像加速
# ============================================================
# npm 注册表镜像
registry=https://registry.npmmirror.com

# Electron 镜像配置 - 使用国内加速源
electron_mirror=https://registry.npmmirror.com/-/binary/electron/
electron_builder_binaries_mirror=https://registry.npmmirror.com/-/binary/electron-builder-binaries/

# Node 版本管理工具镜像（如需使用 nvm）
nodejs_mirror=https://registry.npmmirror.com/-/binary/node/

# ============================================================
# 存储配置 - 提升性能
# ============================================================
# store-dir=D:/pnpm-store  # Windows specific - commented out for cross-platform compatibility
virtual-store-dir-max-length=120

# ============================================================
# 依赖管理 - 自动处理 peer dependencies
# ============================================================
auto-install-peers=true
dedupe-peer-dependents=true

# ============================================================
# Monorepo 支持
# ============================================================
ignore-workspace-root-check=true

# ============================================================
# 性能优化
# ============================================================
prefer-symlinked-executables=false
side-effects-cache=true
side-effects-cache-readonly=false

# ============================================================
# 安全设置
# ============================================================
audit-level=moderate

# ============================================================
# 网络优化
# ============================================================
network-concurrency=16
child-concurrency=5
fetch-timeout=60000
fetch-retry-mintimeout=10000
fetch-retry-maxtimeout=60000
fetch-retries=5

# ============================================================
# 日志配置 - AI 可以更好地理解输出
# ============================================================
reporter=default
log-level=info

# ============================================================
# 构建相关
# ============================================================
enable-pre-post-scripts=true

# ============================================================
# Visual Studio 配置 - 使用 VS 2022 Build Tools 编译原生模块（better-sqlite3）
# ============================================================
msvs_version=2022

# ============================================================
# Git 配置 - 强制使用 HTTPS
# ============================================================
git-shallow-hosts=github.com
git-depth=1

# ============================================================
# pnpm/corepack 推荐设置
# ============================================================
# - prefer-frozen-lockfile: 安装时避免意外的 lockfile 更新
# - node-linker: 使用 isolated 布局以获得更好的依赖隔离
# - save-exact: 确保依赖版本被记录为精确版本
prefer-frozen-lockfile=true
node-linker=isolated
save-exact=true

# ============================================================
# 项目特定配置 (DailyUse 项目)
# ============================================================
# 严格的 peer 依赖检查
strict-peer-dependencies=false

# 允许 node_modules 中的符号链接
symlink=true

# 优先使用 pnpm 的锁文件
use-lockfile=true
