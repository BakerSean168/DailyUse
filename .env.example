# DailyUse 环境配置示例
# =============================================================================
# 本文件包含所有可用的环境变量配置项，按功能分类整理
# 
# 使用说明：
#   1. 复制此文件为 .env（基础共享配置）
#   2. 复制此文件为 .env.development 或 .env.production（环境特定配置）
#   3. 创建 .env.local 或 .env.{NODE_ENV}.local（本地或敏感信息覆盖）
# 
# 文件加载优先级（后覆盖前）：
#   .env → .env.{NODE_ENV} → .env.local → .env.{NODE_ENV}.local → OS env vars
#
# .gitignore 规则（已配置）：
#   ✅ 可提交:  .env, .env.development, .env.production, .env.example
#   ❌ 不提交:  .env.local, .env.*.local (含敏感信息)
#
# 配置项说明：
#   ✅ 必需:    应用启动时必须提供
#   ⚠️  重要:   强烈建议配置，否则功能受限
#   ℹ️  可选:   可选配置，有默认值
#   💬 已注释: 暂不需要，但可选启用
# =============================================================================

# =============================================================================
# 1️⃣  应用基础配置
# =============================================================================
# 应用环境: development | production | test
NODE_ENV=development

# API 服务
API_PORT=3000                          # ℹ️  API 监听端口（Docker 内部）
API_HOST=0.0.0.0                       # ℹ️  API 监听地址（0.0.0.0 = 所有网卡）
LOG_LEVEL=debug                        # ℹ️  日志级别: debug | info | warn | error

# 应用元信息
APP_NAME=DailyUse                       # ℹ️  应用名称
APP_VERSION=0.1.0                       # ℹ️  应用版本
TZ=Asia/Shanghai                        # ℹ️  时区

# =============================================================================
# 2️⃣  Docker 镜像配置
# =============================================================================
# Docker 镜像仓库
REGISTRY=docker.io                      # ℹ️  镜像仓库地址（docker.io | 阿里云镜像仓库 等）
IMAGE_NAMESPACE=dailyuse                # ℹ️  镜像命名空间

# 各服务镜像版本标签
API_TAG=v1.0.3                          # ℹ️  API 镜像版本标签
WEB_TAG=v1.0.1                          # ℹ️  Web 前端镜像版本标签

# =============================================================================
# 3️⃣  数据库配置 (PostgreSQL)
# =============================================================================
# 推荐使用分解配置（Docker 最佳实践）✅
# 
# 处理逻辑：
#   • 如果提供 DATABASE_URL，直接使用（优先级最高）
#   • 否则从 DB_* 变量自动生成：
#     postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?schema=public
# 
# 优势：
#   • Docker Compose 中轻松变量替换 ${DB_HOST}
#   • PostgreSQL 和 API 容器共用配置
#   • 特殊字符无需 URL 编码
#   • 清晰易维护

# ✅ 推荐方案：分解配置
DB_HOST=localhost                       # ⚠️  数据库主机（localhost | postgres 服务名）
DB_PORT=5432                            # ℹ️  数据库端口（默认 5432）
DB_NAME=dailyuse                        # ℹ️  数据库名（默认 dailyuse）
DB_USER=dailyuse                        # ℹ️  数据库用户（默认 dailyuse）
DB_PASSWORD=your-secure-password        # ⚠️  数据库密码（生产环境必须改为强密码）

# ⚠️  备选方案：完整连接字符串（不推荐）
# 如果提供此变量，应用会忽略上面的 DB_* 配置
# DATABASE_URL=postgresql://user:password@localhost:5432/dailyuse?schema=public

# =============================================================================
# 4️⃣  Redis 缓存配置
# =============================================================================
# Redis 连接方式（二选一）

# 推荐方案 1：分解配置（Docker 最佳实践）✅
REDIS_HOST=localhost                    # ℹ️  Redis 主机（localhost | redis 服务名）
REDIS_PORT=6379                         # ℹ️  Redis 端口（默认 6379）
REDIS_PASSWORD=                         # ⚠️  Redis 密码（无密码留空，生产环境需要密码）
REDIS_DB=0                              # ℹ️  Redis 数据库号（默认 0）

# 备选方案 2：完整连接字符串（不推荐）
# 如果提供此变量，应用会忽略上面的 REDIS_* 配置
# REDIS_URL=redis://:password@localhost:6379/0

# =============================================================================
# 5️⃣  JWT 认证配置
# =============================================================================
# ⚠️  生产环境必须使用强随机密钥！
# 生成强密钥命令：
#   macOS/Linux:  openssl rand -base64 64
#   PowerShell:   [Convert]::ToBase64String($(New-Object -TypeName byte[] -ArgumentList 64 | % { $_[+$_] = Get-Random -Maximum 256 }))

JWT_SECRET=dev-jwt-secret-change-me-in-production-at-least-32-chars  # ⚠️  JWT 签名密钥（最少 32 字符）
JWT_EXPIRES_IN=7d                       # ℹ️  JWT Token 有效期（7d | 24h | 3600 等）
JWT_REFRESH_EXPIRES_IN=30d              # ℹ️  刷新 Token 有效期

# 可选：使用单独的刷新 Token 密钥
# REFRESH_TOKEN_SECRET=your-refresh-token-secret  # ℹ️  默认使用 JWT_SECRET，可选覆盖

# =============================================================================
# 6️⃣  CORS 跨域配置
# =============================================================================
# 允许的请求来源（逗号分隔多个，* = 允许所有）
# ⚠️  生产环境不要使用 *，必须指定具体域名！
CORS_ORIGIN=http://localhost:5173,http://localhost:5174,http://127.0.0.1:5173,http://127.0.0.1:5174
# CORS_ORIGIN=https://app.example.com,https://admin.example.com  # 生产环境示例

# =============================================================================
# 7️⃣  Web 前端配置
# =============================================================================
# Web 服务
WEB_PORT=8080                           # ℹ️  Web 服务端口（Docker 内部）

# Vite 环境变量（前端编译时使用）
VITE_API_BASE_URL=/api/v1               # ℹ️  API 基础路径（相对路径由 Nginx 反向代理）
VITE_API_URL=http://localhost:3000      # ℹ️  完整 API 地址（仅开发环境，生产用相对路径）

# 应用域名（生产环境）
APP_DOMAIN=dailyuse.bakersean.top       # ℹ️  应用前端域名（用于生成链接）
API_DOMAIN=api.dailyuse.bakersean.top   # ℹ️  API 域名（用于生成文档链接）

# =============================================================================
# 8️⃣  文件上传配置
# =============================================================================
UPLOAD_MAX_SIZE=10485760                # ℹ️  最大上传文件大小（字节，默认 10MB）
# UPLOAD_PATH=/app/uploads              # ℹ️  上传文件保存路径（可选）

# =============================================================================
# 9️⃣  AI 服务配置（可选）
# =============================================================================
# OpenAI API（用于 AI 对话、分析功能）
# OPENAI_API_KEY=sk-your-api-key                          # 💬 OpenAI 密钥
# OPENAI_MODEL=gpt-4-turbo-preview                        # 💬 默认模型
# OPENAI_BASE_URL=https://api.openai.com/v1              # 💬 API 地址

# 七牛云 AI 服务（可选替代方案）
# QI_NIU_YUN_API_KEY=your-key                             # 💬 七牛云密钥
# QI_NIU_YUN_BASE_URL=https://ai.qiniuapi.com            # 💬 七牛云 API 地址
# QI_NIU_YUN_MODEL_ID=your-model-id                       # 💬 模型 ID

# AI Provider 加密密钥（用于加密 API 密钥存储）
# AI_PROVIDER_ENCRYPTION_KEY=12345678901234567890123456789012  # 💬 32 字节加密密钥

# =============================================================================
# 🔟 邮件服务配置（可选）
# =============================================================================
# SMTP 邮件服务（用于发送验证码、通知等）
# SMTP_HOST=smtp.gmail.com                                # 💬 SMTP 服务器地址
# SMTP_PORT=587                                           # 💬 SMTP 端口（587=TLS, 465=SSL）
# SMTP_USER=your-email@gmail.com                          # 💬 发件人邮箱
# SMTP_PASS=your-app-password                             # 💬 应用密码（非真实密码）
# SMTP_FROM=DailyUse <noreply@dailyuse.com>              # 💬 发件人显示名

# =============================================================================
# 1️⃣1️⃣ 阿里云 OSS 配置（可选）
# =============================================================================
# 用于存储用户上传的文件（替代本地存储）
# ALIYUN_ACCESS_KEY_ID=your-access-key-id                 # 💬 阿里云 AccessKey ID
# ALIYUN_ACCESS_KEY_SECRET=your-access-key-secret         # 💬 阿里云 AccessKey Secret
# ALIYUN_OSS_BUCKET=dailyuse-bucket                       # 💬 OSS Bucket 名称
# ALIYUN_OSS_REGION=oss-cn-hangzhou                       # 💬 OSS 地域
# ALIYUN_OSS_ENDPOINT=https://oss-cn-hangzhou.aliyuncs.com  # 💬 OSS 端点

# =============================================================================
# 1️⃣2️⃣ 监控和错误追踪配置（可选）
# =============================================================================
# Sentry 错误追踪（用于生产环境监控）
# SENTRY_DSN=https://xxxxx@sentry.io/xxxxx                # 💬 Sentry 项目 DSN

# 日志文件（可选，默认仅输出到控制台）
# LOG_FILE=/var/log/dailyuse/app.log                      # 💬 日志文件路径

# =============================================================================
# 1️⃣3️⃣ 功能开关
# =============================================================================
# 日常分析功能
ENABLE_DAILY_ANALYSIS=true              # ℹ️  是否启用日常统计分析（true | false）

# 定时任务调度
USE_PRIORITY_QUEUE_SCHEDULER=true       # ℹ️  是否使用优先级队列调度器（true | false）

# =============================================================================
# 1️⃣4️⃣ 构建信息（CI/CD 自动注入，无需手动设置）
# =============================================================================
# BUILD_TIMESTAMP=2025-12-22T10:30:00Z   # 💬 构建时间戳（自动注入）
# GIT_COMMIT=abc1234567890def           # 💬 Git 提交 Hash（自动注入）
# GIT_BRANCH=main                        # 💬 Git 分支名（自动注入）

# 允许的 CORS 来源
# CORS_ORIGIN=http://localhost,http://localhost:3000,https://yourdomain.com
