# STORY-048: äº‘åŒæ­¥é…ç½®å‘å¯¼ UI

## ğŸ“‹ Story æ¦‚è¿°

**Story ID**: STORY-048  
**Epic**: EPIC-009 (Cloud Sync Integration)  
**ä¼˜å…ˆçº§**: P1 (ç”¨æˆ·åŠŸèƒ½)  
**é¢„ä¼°å·¥æ—¶**: 4 å¤©  
**çŠ¶æ€**: ğŸ“‹ Ready for Dev  
**å‰ç½®ä¾èµ–**: STORY-043, STORY-044, STORY-045, STORY-046, STORY-047

---

## ğŸ¯ ç”¨æˆ·æ•…äº‹

**ä½œä¸º** DailyUse ç”¨æˆ·  
**æˆ‘å¸Œæœ›** æœ‰ä¸€ä¸ªç®€å•çš„å‘å¯¼æ¥é…ç½®äº‘åŒæ­¥  
**ä»¥ä¾¿äº** æˆ‘èƒ½å¿«é€Ÿé€‰æ‹©äº‘å¹³å°å¹¶è®¾ç½®åŒæ­¥ï¼Œè€Œä¸éœ€è¦äº†è§£æŠ€æœ¯ç»†èŠ‚

---

## ğŸ“‹ éªŒæ”¶æ ‡å‡†

### å‘å¯¼ UI éªŒæ”¶

- [ ] åˆ†æ­¥å‘å¯¼ (Step 1-4)
- [ ] æ”¯æŒè¿”å›ä¸Šä¸€æ­¥
- [ ] æ”¯æŒè·³è¿‡æ­¥éª¤
- [ ] æ”¯æŒä¿å­˜è¿›åº¦
- [ ] å®Œæˆåæ˜¾ç¤ºæ€»ç»“

### Step 1: é€‰æ‹©äº‘å¹³å°éªŒæ”¶

- [ ] æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å¹³å° (GitHub, Nutstore, Dropbox, Self-hosted)
- [ ] æ¯ä¸ªå¹³å°æ˜¾ç¤ºæ ‡å¿—å’Œæè¿°
- [ ] æ˜¾ç¤ºå¹³å°ç‰¹æ€§å’Œé™åˆ¶
- [ ] æ˜¾ç¤ºä»·æ ¼ä¿¡æ¯ (Free/Paid)
- [ ] æ”¯æŒç‚¹å‡»äº†è§£æ›´å¤š

### Step 2: è®¤è¯éªŒæ”¶

- [ ] æ ¹æ®å¹³å°æ˜¾ç¤ºç›¸åº”çš„è®¤è¯è¡¨å•
- [ ] GitHub: Token è¾“å…¥æ¡†
- [ ] Nutstore: ç”¨æˆ·å/å¯†ç 
- [ ] Dropbox: OAuth2 æŒ‰é’®
- [ ] Self-hosted: æœåŠ¡å™¨åœ°å€è¾“å…¥
- [ ] éªŒè¯è®¤è¯ä¿¡æ¯
- [ ] æ˜¾ç¤ºè®¤è¯è¿›åº¦
- [ ] é”™è¯¯æç¤º

### Step 3: åŠ å¯†å¯†é’¥è®¾ç½®éªŒæ”¶

- [ ] å¯†ç è¾“å…¥æ¡† (æ˜¾ç¤ºå¼ºåº¦æŒ‡ç¤º)
- [ ] ç¡®è®¤å¯†ç 
- [ ] å¯†ç å¼ºåº¦æç¤º
- [ ] æ˜¾ç¤ºç†µå€¼å’Œè¯„åˆ†
- [ ] æ”¯æŒç”Ÿæˆéšæœºå¯†ç 
- [ ] å¯†ç è¦æ±‚è¯´æ˜

### Step 4: æ•°æ®åŒæ­¥é€‰é¡¹éªŒæ”¶

- [ ] é€‰æ‹©åŒæ­¥æ–¹å‘ (é¦–æ¬¡åŒæ­¥)
  - [ ] ä¸Šä¼ æœ¬åœ°æ•°æ®åˆ°äº‘
  - [ ] ä¸‹è½½äº‘æ•°æ®åˆ°æœ¬åœ°
  - [ ] æ‰‹åŠ¨é€‰æ‹©
- [ ] é¢„è§ˆè¦åŒæ­¥çš„æ•°æ®
- [ ] æ˜¾ç¤ºåŒæ­¥ç»Ÿè®¡ (ç›®æ ‡æ•°ã€ä»»åŠ¡æ•°ç­‰)
- [ ] æ”¯æŒé€‰æ‹©è¦åŒæ­¥çš„å®ä½“ç±»å‹
- [ ] æ˜¾ç¤ºé¢„è®¡æ—¶é—´

### å®Œæˆæ€»ç»“éªŒæ”¶

- [ ] æ˜¾ç¤ºé…ç½®ä¿¡æ¯
- [ ] æ˜¾ç¤ºåŒæ­¥çŠ¶æ€
- [ ] æ˜¾ç¤ºå»ºè®®çš„åç»­æ­¥éª¤
- [ ] æ”¯æŒç«‹å³å¼€å§‹åŒæ­¥æˆ–ç¨å
- [ ] æ”¯æŒç¼–è¾‘é…ç½®

### å¯ç”¨æ€§éªŒæ”¶

- [ ] å“åº”å¼è®¾è®¡ (æ¡Œé¢ã€å¹³æ¿ã€æ‰‹æœº)
- [ ] é”®ç›˜å¯¼èˆªæ”¯æŒ
- [ ] æ— éšœç¢å‹å¥½ (ARIA æ ‡ç­¾)
- [ ] æš—è‰²ä¸»é¢˜æ”¯æŒ
- [ ] é”™è¯¯æ¶ˆæ¯æ¸…æ™°

### å®‰å…¨éªŒæ”¶

- [ ] å¯†é’¥ä¸æ˜¾ç¤ºåœ¨å±å¹•ä¸Š
- [ ] ä¸åœ¨æ—¥å¿—ä¸­è®°å½•æ•æ„Ÿä¿¡æ¯
- [ ] HTTPS è®¤è¯
- [ ] Token å­—æ®µæ©ç›–

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

### ç»„ä»¶ç»“æ„

```typescript
// apps/desktop/src/renderer/components/sync/SyncConfigWizard.tsx

import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useAsync } from '@hooks';
import { useSyncStore } from '@stores/sync';
import {
  StepProvider,
  StepContent,
  StepIndicator,
} from '@components/ui/stepper';

/**
 * äº‘åŒæ­¥é…ç½®å‘å¯¼
 * 
 * åˆ† 4 æ­¥å¼•å¯¼ç”¨æˆ·é…ç½®äº‘åŒæ­¥:
 * 1. é€‰æ‹©äº‘å¹³å°
 * 2. è®¤è¯ä¿¡æ¯
 * 3. åŠ å¯†å¯†é’¥
 * 4. æ•°æ®åŒæ­¥é€‰é¡¹
 */
export const SyncConfigWizard: React.FC<{ onComplete: () => void }> = ({
  onComplete,
}) => {
  const [currentStep, setCurrentStep] = useState(1);
  const [config, setConfig] = useState<SyncConfig>({
    provider: undefined,
    credentials: {},
    encryptionKey: '',
    syncOptions: {},
  });
  
  const { status, execute: testConnection } = useAsync(
    async (creds) => {
      // æµ‹è¯•è¿æ¥
    }
  );
  
  const handleNext = async () => {
    if (currentStep === 2) {
      // æµ‹è¯•è¿æ¥
      await testConnection(config.credentials);
    }
    setCurrentStep(prev => Math.min(prev + 1, 4));
  };
  
  const handlePrev = () => {
    setCurrentStep(prev => Math.max(prev - 1, 1));
  };
  
  const handleComplete = async () => {
    // ä¿å­˜é…ç½®å¹¶å¼€å§‹åŒæ­¥
    await saveSyncConfig(config);
    onComplete();
  };
  
  return (
    <div className="sync-config-wizard">
      {/* æ­¥éª¤æŒ‡ç¤º */}
      <StepIndicator
        currentStep={currentStep}
        totalSteps={4}
        labels={[
          'é€‰æ‹©å¹³å°',
          'è®¤è¯',
          'åŠ å¯†å¯†é’¥',
          'åŒæ­¥é€‰é¡¹',
        ]}
      />
      
      {/* æ­¥éª¤å†…å®¹ */}
      <AnimatePresence mode="wait">
        <motion.div
          key={currentStep}
          initial={{ opacity: 0, x: 20 }}
          animate={{ opacity: 1, x: 0 }}
          exit={{ opacity: 0, x: -20 }}
          className="step-content"
        >
          {currentStep === 1 && (
            <Step1SelectProvider
              selected={config.provider}
              onChange={(provider) =>
                setConfig(prev => ({ ...prev, provider }))
              }
            />
          )}
          
          {currentStep === 2 && (
            <Step2Authentication
              provider={config.provider!}
              credentials={config.credentials}
              onChange={(credentials) =>
                setConfig(prev => ({ ...prev, credentials }))
              }
              isLoading={status === 'pending'}
            />
          )}
          
          {currentStep === 3 && (
            <Step3EncryptionKey
              password={config.encryptionKey}
              onChange={(encryptionKey) =>
                setConfig(prev => ({ ...prev, encryptionKey }))
              }
            />
          )}
          
          {currentStep === 4 && (
            <Step4SyncOptions
              provider={config.provider!}
              syncOptions={config.syncOptions}
              onChange={(syncOptions) =>
                setConfig(prev => ({ ...prev, syncOptions }))
              }
            />
          )}
        </motion.div>
      </AnimatePresence>
      
      {/* å¯¼èˆªæŒ‰é’® */}
      <div className="wizard-navigation">
        <button
          onClick={handlePrev}
          disabled={currentStep === 1}
          className="btn-secondary"
        >
          â† ä¸Šä¸€æ­¥
        </button>
        
        {currentStep < 4 && (
          <button
            onClick={handleNext}
            disabled={!isStepValid(currentStep, config)}
            className="btn-primary"
          >
            ä¸‹ä¸€æ­¥ â†’
          </button>
        )}
        
        {currentStep === 4 && (
          <button
            onClick={handleComplete}
            className="btn-primary"
          >
            å®Œæˆé…ç½®
          </button>
        )}
      </div>
    </div>
  );
};
```

### Step 1: é€‰æ‹©äº‘å¹³å°

```typescript
// apps/desktop/src/renderer/components/sync/Step1SelectProvider.tsx

interface ProviderInfo {
  id: string;
  name: string;
  icon: string;
  description: string;
  features: string[];
  limitations: string[];
  pricing: 'free' | 'paid';
}

const PROVIDERS: Record<string, ProviderInfo> = {
  github: {
    id: 'github',
    name: 'GitHub',
    icon: 'ğŸ™',
    description: 'ä½¿ç”¨ GitHub ç§æœ‰ä»“åº“ä½œä¸ºäº‘å­˜å‚¨',
    features: [
      'å®Œå…¨å…è´¹',
      'ç‰ˆæœ¬æ§åˆ¶',
      'æ— é™å­˜å‚¨ç©ºé—´',
      'å…¨çƒ CDN',
    ],
    limitations: [
      'éœ€è¦ GitHub è´¦æˆ·',
      'API é™æµ (5000/å°æ—¶)',
    ],
    pricing: 'free',
  },
  nutstore: {
    id: 'nutstore',
    name: 'åšæœäº‘',
    icon: 'ğŸ¥œ',
    description: 'å›½å†…ç”¨æˆ·æ¨èï¼ŒWebDAV æ”¯æŒ',
    features: [
      'å…è´¹ 3GB å­˜å‚¨',
      'é€Ÿåº¦å¿« (å›½å†…æœåŠ¡)',
      'WebDAV æ”¯æŒ',
      'ç½‘é¡µç‰ˆè®¿é—®',
    ],
    limitations: [
      'å…è´¹ç‰ˆå®¹é‡æœ‰é™',
      'ä¸Šä¼ é€Ÿåº¦é™åˆ¶',
    ],
    pricing: 'free',
  },
  dropbox: {
    id: 'dropbox',
    name: 'Dropbox',
    icon: 'ğŸ“¦',
    description: 'è·¨å¹³å°äº‘å­˜å‚¨è§£å†³æ–¹æ¡ˆ',
    features: [
      'å…è´¹ 2GB å­˜å‚¨',
      'å¤šè®¾å¤‡åŒæ­¥',
      'æ–‡ä»¶ç‰ˆæœ¬å†å²',
      'ç½‘é¡µç‰ˆè®¿é—®',
    ],
    limitations: [
      'å…è´¹ç‰ˆå®¹é‡æœ‰é™',
      'éœ€è¦å›½é™…è´¦æˆ·',
    ],
    pricing: 'free',
  },
  self_hosted: {
    id: 'self_hosted',
    name: 'è‡ªæœ‰æœåŠ¡å™¨',
    icon: 'ğŸ–¥ï¸',
    description: 'å®Œå…¨æ§åˆ¶ï¼Œéƒ¨ç½²è‡ªå·±çš„åŒæ­¥æœåŠ¡å™¨',
    features: [
      'æ— é™å­˜å‚¨ç©ºé—´',
      'å®Œå…¨éšç§',
      'å®Œå…¨æ§åˆ¶',
      'å¯è‡ªå®šä¹‰',
    ],
    limitations: [
      'éœ€è¦éƒ¨ç½²æœåŠ¡å™¨',
      'éœ€è¦ç»´æŠ¤',
      'éœ€è¦è´­ä¹°æœåŠ¡å™¨',
    ],
    pricing: 'paid',
  },
};

export const Step1SelectProvider: React.FC<{
  selected?: string;
  onChange: (provider: string) => void;
}> = ({ selected, onChange }) => {
  return (
    <div className="provider-grid">
      <h2>é€‰æ‹©æ‚¨çš„äº‘å¹³å°</h2>
      <p className="subtitle">é€‰æ‹©ä¸€ä¸ªæä¾›å•†æ¥å­˜å‚¨æ‚¨çš„åŠ å¯†æ•°æ®</p>
      
      <div className="providers">
        {Object.values(PROVIDERS).map(provider => (
          <ProviderCard
            key={provider.id}
            provider={provider}
            selected={selected === provider.id}
            onSelect={() => onChange(provider.id)}
          />
        ))}
      </div>
      
      <div className="info-box">
        <h4>ğŸ’¡ å¦‚ä½•é€‰æ‹©ï¼Ÿ</h4>
        <ul>
          <li><strong>å›½é™…ç”¨æˆ·</strong>: æ¨è GitHub (æœ€ç¨³å®š) æˆ– Dropbox</li>
          <li><strong>å›½å†…ç”¨æˆ·</strong>: æ¨èåšæœäº‘ (é€Ÿåº¦æœ€å¿«)</li>
          <li><strong>éšç§ä¼˜å…ˆ</strong>: æ¨èè‡ªæœ‰æœåŠ¡å™¨</li>
          <li><strong>å¼€å§‹ä½“éªŒ</strong>: é€‰æ‹©ä»»ä½•å…è´¹é€‰é¡¹</li>
        </ul>
      </div>
    </div>
  );
};

interface ProviderCardProps {
  provider: ProviderInfo;
  selected: boolean;
  onSelect: () => void;
}

const ProviderCard: React.FC<ProviderCardProps> = ({
  provider,
  selected,
  onSelect,
}) => (
  <div
    className={`provider-card ${selected ? 'selected' : ''}`}
    onClick={onSelect}
  >
    <div className="icon">{provider.icon}</div>
    <h3>{provider.name}</h3>
    <p>{provider.description}</p>
    
    <div className="features">
      <h4>ç‰¹æ€§</h4>
      <ul>
        {provider.features.map(f => <li key={f}>âœ“ {f}</li>)}
      </ul>
    </div>
    
    <div className="limitations">
      <h4>é™åˆ¶</h4>
      <ul>
        {provider.limitations.map(l => <li key={l}>âš  {l}</li>)}
      </ul>
    </div>
    
    <div className="pricing">
      {provider.pricing === 'free' ? (
        <span className="badge-free">å…è´¹</span>
      ) : (
        <span className="badge-paid">ä»˜è´¹</span>
      )}
    </div>
  </div>
);
```

### Step 2: è®¤è¯

```typescript
// apps/desktop/src/renderer/components/sync/Step2Authentication.tsx

export const Step2Authentication: React.FC<AuthProps> = ({
  provider,
  credentials,
  onChange,
  isLoading,
}) => {
  const [showToken, setShowToken] = useState(false);
  const [error, setError] = useState<string>();
  
  const handleGitHubAuth = async () => {
    // æ‰“å¼€æµè§ˆå™¨è¿›è¡Œ OAuth è®¤è¯
    const token = await getGitHubToken();
    onChange({ token });
  };
  
  return (
    <div className="authentication-form">
      <h2>è¿æ¥åˆ° {getProviderName(provider)}</h2>
      
      {provider === 'github' && (
        <GitHubAuthForm
          credentials={credentials}
          onChange={onChange}
          isLoading={isLoading}
          showToken={showToken}
          onToggleShow={() => setShowToken(!showToken)}
        />
      )}
      
      {provider === 'nutstore' && (
        <NutstoreAuthForm
          credentials={credentials}
          onChange={onChange}
          isLoading={isLoading}
        />
      )}
      
      {provider === 'dropbox' && (
        <DropboxAuthForm
          onClick={handleGitHubAuth}
          isLoading={isLoading}
        />
      )}
      
      {provider === 'self_hosted' && (
        <SelfHostedAuthForm
          credentials={credentials}
          onChange={onChange}
          isLoading={isLoading}
        />
      )}
      
      {error && (
        <div className="error-alert">
          <strong>âŒ è®¤è¯å¤±è´¥</strong>
          <p>{error}</p>
        </div>
      )}
      
      <div className="info-box">
        <h4>ğŸ”’ æ‚¨çš„å‡­è¯å®‰å…¨å—ï¼Ÿ</h4>
        <ul>
          <li>âœ“ å‡­è¯ä¸ä¼šç¦»å¼€æ‚¨çš„è®¡ç®—æœº</li>
          <li>âœ“ ä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨</li>
          <li>âœ“ ä»…ç”¨äºè¿æ¥åˆ°æ‰€é€‰äº‘å¹³å°</li>
          <li>âœ“ Token è¢«åŠ å¯†å­˜å‚¨</li>
        </ul>
      </div>
    </div>
  );
};

// GitHub è®¤è¯è¡¨å•
const GitHubAuthForm: React.FC<GitHubAuthFormProps> = ({
  credentials,
  onChange,
  showToken,
  onToggleShow,
}) => (
  <div className="auth-form">
    <label>
      Personal Access Token
      <a href="https://github.com/settings/tokens" target="_blank">
        ç”Ÿæˆ Token
      </a>
    </label>
    
    <div className="token-input-group">
      <input
        type={showToken ? 'text' : 'password'}
        value={credentials.token || ''}
        onChange={e => onChange({ ...credentials, token: e.target.value })}
        placeholder="ghp_xxxxxxxxxxxxxxxxxxxx"
      />
      <button
        onClick={onToggleShow}
        className="btn-icon"
        title={showToken ? 'éšè—' : 'æ˜¾ç¤º'}
      >
        {showToken ? 'ğŸ‘ï¸' : 'ğŸ™ˆ'}
      </button>
    </div>
    
    <label>
      ä»“åº“è·¯å¾„
      <input
        type="text"
        value={credentials.repoPath || ''}
        onChange={e => onChange({ ...credentials, repoPath: e.target.value })}
        placeholder="owner/repo"
      />
    </label>
    
    <details className="token-help">
      <summary>ğŸ“– å¦‚ä½•ç”Ÿæˆ Tokenï¼Ÿ</summary>
      <ol>
        <li>è®¿é—® <a href="https://github.com/settings/tokens">GitHub è®¾ç½®</a></li>
        <li>ç‚¹å‡» "Generate new token"</li>
        <li>é€‰æ‹© "repo" æƒé™èŒƒå›´</li>
        <li>è®¾ç½®æœ‰æ•ˆæœŸä¸º "No expiration" æˆ– 90 å¤©</li>
        <li>ç‚¹å‡» "Generate token" å¹¶å¤åˆ¶</li>
        <li>ç²˜è´´åˆ°ä¸Šé¢çš„è¾“å…¥æ¡†</li>
      </ol>
    </details>
  </div>
);
```

### Step 3: åŠ å¯†å¯†é’¥

```typescript
// apps/desktop/src/renderer/components/sync/Step3EncryptionKey.tsx

export const Step3EncryptionKey: React.FC<{
  password: string;
  onChange: (password: string) => void;
}> = ({ password, onChange }) => {
  const [confirmPassword, setConfirmPassword] = useState('');
  const [showPassword, setShowPassword] = useState(false);
  const strength = calculatePasswordStrength(password);
  
  return (
    <div className="encryption-key-form">
      <h2>è®¾ç½®åŠ å¯†å¯†é’¥</h2>
      <p className="subtitle">
        è¿™ä¸ªå¯†é’¥å°†åŠ å¯†æ‚¨çš„æ‰€æœ‰æ•°æ®ã€‚è¯·é€‰æ‹©ä¸€ä¸ªå¼ºå¯†ç ã€‚
      </p>
      
      <label>
        åŠ å¯†å¯†é’¥
        <div className="password-input-group">
          <input
            type={showPassword ? 'text' : 'password'}
            value={password}
            onChange={e => onChange(e.target.value)}
            placeholder="è¾“å…¥å¼ºå¯†ç "
          />
          <button
            onClick={() => setShowPassword(!showPassword)}
            className="btn-icon"
          >
            {showPassword ? 'ğŸ‘ï¸' : 'ğŸ™ˆ'}
          </button>
        </div>
      </label>
      
      {/* å¯†ç å¼ºåº¦æŒ‡ç¤º */}
      <PasswordStrengthIndicator strength={strength} password={password} />
      
      {/* ç”Ÿæˆéšæœºå¯†ç  */}
      <button
        onClick={() => onChange(generateSecurePassword())}
        className="btn-secondary"
      >
        ğŸ”€ ç”Ÿæˆå¼ºå¯†ç 
      </button>
      
      <label>
        ç¡®è®¤å¯†é’¥
        <input
          type={showPassword ? 'text' : 'password'}
          value={confirmPassword}
          onChange={e => setConfirmPassword(e.target.value)}
          placeholder="å†æ¬¡è¾“å…¥å¯†é’¥"
        />
      </label>
      
      {password !== confirmPassword && password && confirmPassword && (
        <div className="error-alert">
          âŒ å¯†é’¥ä¸åŒ¹é…
        </div>
      )}
      
      {/* å¯†ç è¦æ±‚ */}
      <div className="requirements">
        <h4>å¯†é’¥è¦æ±‚</h4>
        <ul>
          <li className={password.length >= 12 ? 'met' : ''}>
            âœ“ è‡³å°‘ 12 ä¸ªå­—ç¬¦
          </li>
          <li className={/[A-Z]/.test(password) ? 'met' : ''}>
            âœ“ åŒ…å«å¤§å†™å­—æ¯
          </li>
          <li className={/[a-z]/.test(password) ? 'met' : ''}>
            âœ“ åŒ…å«å°å†™å­—æ¯
          </li>
          <li className={/\d/.test(password) ? 'met' : ''}>
            âœ“ åŒ…å«æ•°å­—
          </li>
          <li className={/[!@#$%^&*]/.test(password) ? 'met' : ''}>
            âœ“ åŒ…å«ç‰¹æ®Šå­—ç¬¦
          </li>
        </ul>
      </div>
      
      <div className="warning-box">
        <strong>âš ï¸ é‡è¦æç¤º</strong>
        <ul>
          <li>ä¸è¦å¿˜è®°è¿™ä¸ªå¯†é’¥ï¼ä¸¢å¤±åæ— æ³•æ¢å¤æ•°æ®ã€‚</li>
          <li>è€ƒè™‘å°†å¯†é’¥å­˜å‚¨åœ¨å¯†ç ç®¡ç†å™¨ä¸­ã€‚</li>
          <li>å¯†é’¥ä¸ä¼šå‘é€åˆ°ä»»ä½•æœåŠ¡å™¨ã€‚</li>
          <li>åªæœ‰æ‚¨æ‹¥æœ‰è§£å¯†æ•°æ®çš„èƒ½åŠ›ã€‚</li>
        </ul>
      </div>
    </div>
  );
};

// å¯†ç å¼ºåº¦æŒ‡ç¤ºå™¨
const PasswordStrengthIndicator: React.FC<{
  strength: StrengthLevel;
  password: string;
}> = ({ strength, password }) => {
  const bars = 5;
  const filledBars = strength.score;
  
  return (
    <div className="strength-indicator">
      <div className="strength-bars">
        {Array.from({ length: bars }).map((_, i) => (
          <div
            key={i}
            className={`bar ${i < filledBars ? 'filled' : ''} ${strength.level}`}
          />
        ))}
      </div>
      
      <div className="strength-text">
        <span className={`level ${strength.level}`}>
          {strength.label}
        </span>
        <span className="entropy">
          ç†µå€¼: {strength.entropy?.toFixed(1)} bits
        </span>
      </div>
      
      {strength.suggestions.length > 0 && (
        <div className="suggestions">
          {strength.suggestions.map(s => (
            <p key={s}>ğŸ’¡ {s}</p>
          ))}
        </div>
      )}
    </div>
  );
};
```

### Step 4: åŒæ­¥é€‰é¡¹

```typescript
// apps/desktop/src/renderer/components/sync/Step4SyncOptions.tsx

export const Step4SyncOptions: React.FC<SyncOptionsProps> = ({
  provider,
  syncOptions,
  onChange,
}) => {
  const [syncDirection, setSyncDirection] = useState<'upload' | 'download' | 'manual'>('upload');
  const [selectedEntities, setSelectedEntities] = useState<string[]>([
    'goals',
    'tasks',
    'reminders',
  ]);
  
  const stats = calculateSyncStats(selectedEntities);
  
  return (
    <div className="sync-options-form">
      <h2>é…ç½®æ•°æ®åŒæ­¥</h2>
      
      <label>
        <strong>é¦–æ¬¡åŒæ­¥æ–¹å‘</strong>
      </label>
      
      <div className="radio-group">
        <label>
          <input
            type="radio"
            value="upload"
            checked={syncDirection === 'upload'}
            onChange={e => setSyncDirection(e.target.value as any)}
          />
          ğŸ“¤ ä¸Šä¼ æœ¬åœ°æ•°æ®åˆ°äº‘
          <small>æ¨èï¼šä¿ç•™æœ¬åœ°æ•°æ®ï¼ŒåŒæ—¶å¤‡ä»½åˆ°äº‘</small>
        </label>
        
        <label>
          <input
            type="radio"
            value="download"
            checked={syncDirection === 'download'}
            onChange={e => setSyncDirection(e.target.value as any)}
          />
          ğŸ“¥ ä¸‹è½½äº‘æ•°æ®åˆ°æœ¬åœ°
          <small>å½“æ‚¨å·²åœ¨å…¶ä»–è®¾å¤‡é…ç½®è¿‡äº‘åŒæ­¥æ—¶é€‰æ‹©</small>
        </label>
        
        <label>
          <input
            type="radio"
            value="manual"
            checked={syncDirection === 'manual'}
            onChange={e => setSyncDirection(e.target.value as any)}
          />
          ğŸ”„ æ‰‹åŠ¨é€‰æ‹©
          <small>é€ä¸ªé€‰æ‹©æ¯ä¸ªå®ä½“ç±»å‹çš„åŒæ­¥æ–¹å‘</small>
        </label>
      </div>
      
      {/* å®ä½“é€‰æ‹© */}
      <label>
        <strong>åŒæ­¥æ•°æ®ç±»å‹</strong>
      </label>
      
      <div className="entity-checklist">
        {['goals', 'tasks', 'reminders', 'schedules'].map(entity => (
          <EntityCheckbox
            key={entity}
            entity={entity}
            checked={selectedEntities.includes(entity)}
            onChange={(checked) => {
              setSelectedEntities(checked
                ? [...selectedEntities, entity]
                : selectedEntities.filter(e => e !== entity)
              );
            }}
          />
        ))}
      </div>
      
      {/* åŒæ­¥ç»Ÿè®¡ */}
      <div className="sync-summary">
        <h4>åŒæ­¥ç»Ÿè®¡</h4>
        <dl>
          <dt>ç›®æ ‡æ•°</dt>
          <dd>{stats.goals}</dd>
          
          <dt>ä»»åŠ¡æ•°</dt>
          <dd>{stats.tasks}</dd>
          
          <dt>æé†’æ•°</dt>
          <dd>{stats.reminders}</dd>
          
          <dt>æ—¥ç¨‹æ•°</dt>
          <dd>{stats.schedules}</dd>
          
          <dt>æ€»è®¡</dt>
          <dd className="total">{stats.total} é¡¹</dd>
          
          <dt>æ•°æ®å¤§å°</dt>
          <dd>{formatBytes(stats.size)}</dd>
          
          <dt>é¢„è®¡æ—¶é—´</dt>
          <dd>{estimateSyncTime(stats.size, provider)} ç§’</dd>
        </dl>
      </div>
      
      <div className="info-box">
        <h4>ğŸ“Œ åŒæ­¥æ³¨æ„äº‹é¡¹</h4>
        <ul>
          <li>é¦–æ¬¡åŒæ­¥å¯èƒ½éœ€è¦ 1-5 åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…</li>
          <li>åŒæ­¥è¿‡ç¨‹ä¸­ï¼Œè¯·ä¿æŒç½‘ç»œè¿æ¥</li>
          <li>ä¸è¦å…³é—­åº”ç”¨ç¨‹åº</li>
          <li>ä¹‹åçš„å¢é‡åŒæ­¥ä¼šå¿«å¾—å¤š</li>
          <li>æ‚¨å¯ä»¥éšæ—¶åœ¨è®¾ç½®ä¸­ä¿®æ”¹åŒæ­¥é…ç½®</li>
        </ul>
      </div>
    </div>
  );
};
```

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

```
apps/desktop/src/renderer/components/sync/
â”œâ”€â”€ SyncConfigWizard.tsx
â”œâ”€â”€ Step1SelectProvider.tsx
â”œâ”€â”€ Step2Authentication.tsx
â”œâ”€â”€ Step3EncryptionKey.tsx
â”œâ”€â”€ Step4SyncOptions.tsx
â”œâ”€â”€ SyncCompletionSummary.tsx
â”œâ”€â”€ styles/
â”‚   â””â”€â”€ wizard.module.css
â””â”€â”€ hooks/
    â”œâ”€â”€ usePasswordStrength.ts
    â””â”€â”€ useSyncPreview.ts
```

### ä¿®æ”¹æ–‡ä»¶

```
apps/desktop/src/renderer/pages/Settings.tsx
  â””â”€â”€ æ·»åŠ "é…ç½®äº‘åŒæ­¥"å¯¼èˆªé¡¹

apps/desktop/src/renderer/App.tsx
  â””â”€â”€ æ·»åŠ è·¯ç”± /settings/sync-wizard

apps/desktop/src/renderer/stores/sync.ts
  â””â”€â”€ æ·»åŠ é…ç½®ä¿å­˜é€»è¾‘
```

---

## ğŸ§ª æµ‹è¯•è¦ç‚¹

### å•å…ƒæµ‹è¯•

- [ ] å¯†ç å¼ºåº¦è®¡ç®—
- [ ] æ•°æ®ç»Ÿè®¡è®¡ç®—
- [ ] éªŒè¯é€»è¾‘

### ç»„ä»¶æµ‹è¯•

- [ ] æ­¥éª¤å¯¼èˆª
- [ ] è¡¨å•éªŒè¯
- [ ] é”™è¯¯å¤„ç†
- [ ] åŠ¨ç”»

### E2E æµ‹è¯•

- [ ] å®Œæ•´çš„å‘å¯¼æµç¨‹
- [ ] æ¯ä¸ªæä¾›å•†çš„è®¤è¯
- [ ] é…ç½®ä¿å­˜
- [ ] é›†æˆåˆ°ä¸»åº”ç”¨

---

## ğŸ¨ UI è®¾è®¡è€ƒè™‘

1. **å“åº”å¼è®¾è®¡**ï¼šæ”¯æŒæ‰€æœ‰è®¾å¤‡å®½åº¦
2. **æš—è‰²æ¨¡å¼**ï¼šé€‚é…ç³»ç»Ÿä¸»é¢˜
3. **æ— éšœç¢**ï¼šARIA æ ‡ç­¾ã€é”®ç›˜å¯¼èˆª
4. **å›½é™…åŒ–**ï¼šä¸­è‹±æ–‡æ”¯æŒ
5. **åŠ è½½çŠ¶æ€**ï¼šæ¸…æ™°çš„è¿›åº¦åé¦ˆ

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. å®ç°åŒæ­¥è®¾ç½®è§†å›¾ (STORY-049)
2. å®ç°å¤šæä¾›å•†æ”¯æŒ (STORY-050)
3. é›†æˆæµ‹è¯• (STORY-055)
