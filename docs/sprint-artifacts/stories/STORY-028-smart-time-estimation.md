# STORY-028: æ™ºèƒ½æ—¶é—´é¢„ä¼°

## ğŸ“‹ Story æ¦‚è¿°

**Story ID**: STORY-028  
**Epic**: EPIC-006 (Smart Productivity)  
**ä¼˜å…ˆçº§**: P1 (æ ¸å¿ƒä»·å€¼)  
**é¢„ä¼°å·¥æ—¶**: 2 å¤©  
**çŠ¶æ€**: ğŸ“‹ Ready for Dev  
**å‰ç½®ä¾èµ–**: ç°æœ‰ Task æ¨¡å— âœ…

---

## ğŸ¯ ç”¨æˆ·æ•…äº‹

**ä½œä¸º** DailyUse ç”¨æˆ·  
**æˆ‘å¸Œæœ›** ç³»ç»Ÿèƒ½åŸºäºå†å²æ•°æ®é¢„ä¼°ä»»åŠ¡è€—æ—¶  
**ä»¥ä¾¿äº** æ›´å‡†ç¡®åœ°è§„åˆ’æ—¥ç¨‹ï¼Œé¿å…è¿‡åº¦ä¹è§‚æˆ–æ‚²è§‚

---

## ğŸ“‹ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶ - æ—¶é—´é¢„ä¼°

- [ ] åˆ›å»ºä»»åŠ¡æ—¶æ˜¾ç¤º AI é¢„ä¼°æ—¶é•¿
- [ ] é¢„ä¼°åŸºäºç”¨æˆ·å†å²å®Œæˆæ•°æ®
- [ ] æ˜¾ç¤ºé¢„ä¼°ç½®ä¿¡åŒºé—´ï¼ˆÂ±20% è¯¯å·®èŒƒå›´ï¼‰
- [ ] ç›¸ä¼¼ä»»åŠ¡è‡ªåŠ¨åŒ¹é…å’Œå‚è€ƒ
- [ ] ç”¨æˆ·å¯æ¥å—æˆ–æ‰‹åŠ¨ä¿®æ”¹é¢„ä¼°

### åŠŸèƒ½éªŒæ”¶ - å†å²æ•°æ®åˆ†æ

- [ ] åˆ†æç”¨æˆ·è¿‡å» 30 å¤©ä»»åŠ¡æ•°æ®
- [ ] æŒ‰ä»»åŠ¡ç±»å‹/æ ‡ç­¾åˆ†ç±»åˆ†æ
- [ ] è€ƒè™‘ä»»åŠ¡å¤æ‚åº¦å› ç´ 
- [ ] è€ƒè™‘æ—¶é—´æ®µæ•ˆç‡å·®å¼‚ï¼ˆæ—©æ™¨ vs æ™šä¸Šï¼‰

### åŠŸèƒ½éªŒæ”¶ - åŠ¨æ€è°ƒæ•´

- [ ] ä»»åŠ¡å¼€å§‹åå®æ—¶è¿½è¸ªè€—æ—¶
- [ ] è¶…æ—¶æ—¶æ˜¾ç¤ºé¢„è­¦æç¤º
- [ ] å®Œæˆåæ›´æ–°é¢„ä¼°æ¨¡å‹
- [ ] æ˜¾ç¤ºé¢„ä¼°å‡†ç¡®åº¦è¶‹åŠ¿

### åŠŸèƒ½éªŒæ”¶ - é¢„ä¼°å‡†ç¡®åº¦è¿½è¸ª

- [ ] Dashboard æ˜¾ç¤ºé¢„ä¼° vs å®é™…å¯¹æ¯”
- [ ] è®¡ç®— MAPE (å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®)
- [ ] å±•ç¤ºæœ€å‡†ç¡®/æœ€ä¸å‡†ç¡®çš„ä»»åŠ¡ç±»å‹
- [ ] æŒç»­ä¼˜åŒ–é¢„ä¼°ç®—æ³•

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

### æ•°æ®æ¨¡å‹

```typescript
// packages/domain-client/src/task/value-objects/
interface TimeEstimation {
  estimatedMinutes: number;
  confidenceInterval: {
    min: number;
    max: number;
  };
  confidence: number;  // 0-1, ç½®ä¿¡åº¦
  basedOn: {
    similarTasksCount: number;
    userHistoryDays: number;
  };
  factors: {
    taskComplexity: 'simple' | 'medium' | 'complex';
    userEfficiencyScore: number;  // 0-1
    timeOfDay?: 'morning' | 'afternoon' | 'evening';
  };
}

interface TaskTimeTracking {
  taskId: string;
  estimatedMinutes: number;
  actualMinutes?: number;
  startedAt?: Date;
  completedAt?: Date;
  accuracy?: number;  // (actual / estimated), ç”¨äºæ¨¡å‹è®­ç»ƒ
}
```

### é¢„ä¼°ç®—æ³•

```typescript
// packages/application-client/src/task/services/TimeEstimationService.ts
export class TimeEstimationService {
  /**
   * é¢„ä¼°ä»»åŠ¡è€—æ—¶
   */
  async estimateTaskDuration(task: {
    title: string;
    description?: string;
    tags?: string[];
    complexity?: string;
  }): Promise<TimeEstimation> {
    // 1. æŸ¥æ‰¾ç›¸ä¼¼ä»»åŠ¡
    const similarTasks = await this.findSimilarTasks(task);
    
    // 2. åˆ†æç”¨æˆ·å†å²æ•ˆç‡
    const userEfficiency = await this.calculateUserEfficiency();
    
    // 3. æ—¶é—´æ®µæ•ˆç‡è°ƒæ•´
    const timeOfDayFactor = this.getTimeOfDayFactor();
    
    // 4. è®¡ç®—åŸºç¡€é¢„ä¼°
    const baseEstimate = this.calculateBaseEstimate(
      similarTasks,
      task.complexity
    );
    
    // 5. åº”ç”¨è°ƒæ•´å› å­
    const adjusted = baseEstimate * userEfficiency * timeOfDayFactor;
    
    // 6. è®¡ç®—ç½®ä¿¡åŒºé—´
    const confidence = this.calculateConfidence(similarTasks.length);
    
    return {
      estimatedMinutes: Math.round(adjusted),
      confidenceInterval: {
        min: Math.round(adjusted * 0.8),
        max: Math.round(adjusted * 1.2),
      },
      confidence,
      basedOn: {
        similarTasksCount: similarTasks.length,
        userHistoryDays: 30,
      },
      factors: {
        taskComplexity: task.complexity,
        userEfficiencyScore: userEfficiency,
        timeOfDay: this.getCurrentTimeOfDay(),
      },
    };
  }

  /**
   * ç›¸ä¼¼ä»»åŠ¡åŒ¹é… (åŸºäºå‘é‡ç›¸ä¼¼åº¦)
   */
  private async findSimilarTasks(task: Task): Promise<TaskTimeTracking[]> {
    // ä½¿ç”¨ TF-IDF æˆ–ç®€å•å…³é”®è¯åŒ¹é…
    // è€ƒè™‘: æ ‡é¢˜ç›¸ä¼¼åº¦ã€æ ‡ç­¾é‡åˆåº¦ã€å¤æ‚åº¦ç›¸åŒ
  }

  /**
   * ç”¨æˆ·æ•ˆç‡è®¡ç®—
   */
  private async calculateUserEfficiency(): Promise<number> {
    // æœ€è¿‘ 30 å¤©çš„ actual/estimated å¹³å‡å€¼
    // è€ƒè™‘å­¦ä¹ æ›²çº¿å’Œç–²åŠ³å› ç´ 
  }

  /**
   * æ—¶é—´æ®µæ•ˆç‡å› å­
   */
  private getTimeOfDayFactor(): number {
    const hour = new Date().getHours();
    if (hour >= 8 && hour < 12) return 1.0;   // æ—©æ™¨é«˜æ•ˆ
    if (hour >= 12 && hour < 14) return 0.8;  // åˆä¼‘ä½æ•ˆ
    if (hour >= 14 && hour < 18) return 0.9;  // ä¸‹åˆä¸­ç­‰
    return 0.7;  // æ™šä¸Šç–²åŠ³
  }

  /**
   * è¿½è¸ªå®é™…è€—æ—¶
   */
  async trackActualTime(taskId: string): Promise<void> {
    // ä»»åŠ¡å¼€å§‹æ—¶è®°å½•
    // ä»»åŠ¡å®Œæˆæ—¶è®¡ç®—å®é™…è€—æ—¶
    // æ›´æ–°å‡†ç¡®åº¦ç»Ÿè®¡
  }

  /**
   * è·å–é¢„ä¼°å‡†ç¡®åº¦
   */
  async getEstimationAccuracy(): Promise<{
    mape: number;  // Mean Absolute Percentage Error
    tasks: Array<{
      taskId: string;
      estimated: number;
      actual: number;
      error: number;
    }>;
  }> {
    // è®¡ç®—æœ€è¿‘ 50 ä¸ªä»»åŠ¡çš„é¢„ä¼°å‡†ç¡®åº¦
  }
}
```

### UI ç»„ä»¶

```
åˆ›å»ºä»»åŠ¡æ—¶:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°å»ºä»»åŠ¡                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»»åŠ¡åç§° *                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç¼–å†™äº§å“éœ€æ±‚æ–‡æ¡£                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                      â”‚
â”‚  ğŸ“Š AI é¢„ä¼°æ—¶é•¿: 2 å°æ—¶ (Â±20%)                      â”‚
â”‚  åŸºäº 5 ä¸ªç›¸ä¼¼ä»»åŠ¡ | ç½®ä¿¡åº¦: é«˜                      â”‚
â”‚                                                      â”‚
â”‚  æ—¶é•¿ (åˆ†é’Ÿ)                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 120                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  [ ] ä½¿ç”¨ AI é¢„ä¼°æ—¶é•¿                               â”‚
â”‚                                                      â”‚
â”‚  å¤æ‚åº¦                                              â”‚
â”‚  â—‹ ç®€å•  â— ä¸­ç­‰  â—‹ å¤æ‚                             â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ä»»åŠ¡è¿›è¡Œä¸­:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç¼–å†™äº§å“éœ€æ±‚æ–‡æ¡£                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â± å·²ç”¨æ—¶: 1å°æ—¶35åˆ† / é¢„ä¼° 2å°æ—¶                   â”‚
â”‚  è¿›åº¦: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 79%                               â”‚
â”‚                                                      â”‚
â”‚  âš ï¸ æç¤º: å³å°†è¶…è¿‡é¢„ä¼°æ—¶é—´ (å‰©ä½™ 25 åˆ†é’Ÿ)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Dashboard å‡†ç¡®åº¦ç»Ÿè®¡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ—¶é—´é¢„ä¼°å‡†ç¡®åº¦                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¹³å‡è¯¯å·®: 15% (è¿‘ 30 å¤©)                            â”‚
â”‚  è¶‹åŠ¿: ğŸ“ˆ æŒç»­æ”¹å–„ä¸­                                 â”‚
â”‚                                                      â”‚
â”‚  æœ€å‡†ç¡®çš„ä»»åŠ¡ç±»å‹:                                   â”‚
â”‚  â€¢ ä»£ç å®¡æŸ¥ (5% è¯¯å·®)                                â”‚
â”‚  â€¢ ä¼šè®®è®°å½• (8% è¯¯å·®)                                â”‚
â”‚                                                      â”‚
â”‚  éœ€è¦æ”¹è¿›çš„ä»»åŠ¡ç±»å‹:                                 â”‚
â”‚  â€¢ æ–‡æ¡£ç¼–å†™ (25% è¯¯å·®) âš ï¸                            â”‚
â”‚  â€¢ éœ€æ±‚åˆ†æ (30% è¯¯å·®) âš ï¸                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

```
packages/domain-client/src/task/value-objects/
  â””â”€â”€ TimeEstimation.ts

packages/application-client/src/task/services/
  â””â”€â”€ TimeEstimationService.ts

packages/contracts/src/modules/task/
  â””â”€â”€ time-estimation.types.ts

apps/api/src/modules/task/application/
  â””â”€â”€ TimeEstimationUseCase.ts

apps/desktop/src/renderer/components/task/
  â”œâ”€â”€ TimeEstimationBadge.tsx
  â”œâ”€â”€ TimeTrackingProgress.tsx
  â””â”€â”€ EstimationAccuracyChart.tsx
```

### ä¿®æ”¹æ–‡ä»¶

```
apps/desktop/src/renderer/views/task/TaskFormDialog.tsx
  â””â”€â”€ æ·»åŠ  AI æ—¶é—´é¢„ä¼°å»ºè®®

apps/desktop/src/renderer/views/task/TaskDetailView.tsx
  â””â”€â”€ æ˜¾ç¤ºå®æ—¶è€—æ—¶è¿½è¸ª

apps/desktop/src/renderer/views/dashboard/DashboardView.tsx
  â””â”€â”€ æ·»åŠ é¢„ä¼°å‡†ç¡®åº¦ç»Ÿè®¡å¡ç‰‡
```

---

## ğŸ§ª æµ‹è¯•è¦ç‚¹

### å•å…ƒæµ‹è¯•

- ç›¸ä¼¼ä»»åŠ¡åŒ¹é…ç®—æ³•
- æ—¶é—´æ®µæ•ˆç‡å› å­è®¡ç®—
- MAPE å‡†ç¡®åº¦è®¡ç®—

### é›†æˆæµ‹è¯•

- å†å²æ•°æ®æŸ¥è¯¢æ€§èƒ½
- å®æ—¶è€—æ—¶è¿½è¸ªæ›´æ–°
- é¢„ä¼°æ¨¡å‹æŒç»­ä¼˜åŒ–

### E2E æµ‹è¯•

- å®Œæ•´é¢„ä¼°æµç¨‹
- å®é™…è€—æ—¶è®°å½•
- å‡†ç¡®åº¦ç»Ÿè®¡å±•ç¤º

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å†·å¯åŠ¨é—®é¢˜**ï¼šæ–°ç”¨æˆ·æ— å†å²æ•°æ®æ—¶ä½¿ç”¨è¡Œä¸šå¹³å‡å€¼
2. **éšç§ä¿æŠ¤**ï¼šæ‰€æœ‰åˆ†æåœ¨æœ¬åœ°è¿›è¡Œï¼Œä¸ä¸Šä¼ ä»»åŠ¡å†…å®¹
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šé¢„ä¼°è®¡ç®—å¼‚æ­¥è¿›è¡Œï¼Œä¸é˜»å¡ UI
4. **æ¨¡å‹æ›´æ–°**ï¼šæ¯å‘¨é‡æ–°è®­ç»ƒé¢„ä¼°æ¨¡å‹
