# STORY-033: ä¸“æ³¨æ¨¡å¼ UI

## ğŸ“‹ Story æ¦‚è¿°

**Story ID**: STORY-033  
**Epic**: EPIC-007 (Pomodoro & Focus Mode)  
**ä¼˜å…ˆçº§**: P1 (æ ¸å¿ƒä»·å€¼)  
**é¢„ä¼°å·¥æ—¶**: 2 å¤©  
**çŠ¶æ€**: ğŸ“‹ Ready for Dev  
**å‰ç½®ä¾èµ–**: STORY-032 âœ… (Pomodoro Timer)

---

## ğŸ¯ ç”¨æˆ·æ•…äº‹

**ä½œä¸º** DailyUse æ¡Œé¢ç”¨æˆ·  
**æˆ‘å¸Œæœ›** è¿›å…¥ä¸“æ³¨æ¨¡å¼æ—¶ç•Œé¢ç®€åŒ–ï¼Œåªæ˜¾ç¤ºå½“å‰ä»»åŠ¡  
**ä»¥ä¾¿äº** å±è”½å¹²æ‰°ï¼Œè¿›å…¥æ·±åº¦å·¥ä½œçŠ¶æ€

---

## ğŸ“‹ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶ - ä¸“æ³¨è§†å›¾

- [ ] å…¨å±æˆ–å¤§çª—å£ä¸“æ³¨è§†å›¾
- [ ] æ˜¾ç¤ºå½“å‰ä»»åŠ¡åç§°å’Œæè¿°
- [ ] æ˜¾ç¤ºç•ªèŒ„é’Ÿå€’è®¡æ—¶ï¼ˆå¤§å­—ä½“ï¼‰
- [ ] æœ€å°åŒ–å…¶ä»– UI å…ƒç´ 
- [ ] æŸ”å’Œçš„èƒŒæ™¯è‰²/æ¸å˜

### åŠŸèƒ½éªŒæ”¶ - å¿«æ·æ“ä½œ

- [ ] Esc é”®é€€å‡ºä¸“æ³¨æ¨¡å¼
- [ ] ç©ºæ ¼é”®æš‚åœ/ç»§ç»­
- [ ] é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæ§åˆ¶æ¡
- [ ] å¿«æ·é”®åˆ‡æ¢ä»»åŠ¡
- [ ] å¿«é€Ÿè®°å½•ç¬”è®°åŠŸèƒ½

### åŠŸèƒ½éªŒæ”¶ - å‹¿æ‰°é›†æˆ

- [ ] è‡ªåŠ¨å¼€å¯ç³»ç»Ÿå‹¿æ‰°æ¨¡å¼
- [ ] éšè—æ¡Œé¢é€šçŸ¥
- [ ] æš‚åœéç´§æ€¥æé†’
- [ ] é€€å‡ºæ—¶æ¢å¤é€šçŸ¥çŠ¶æ€

### åŠŸèƒ½éªŒæ”¶ - è§†è§‰æ•ˆæœ

- [ ] å¹³æ»‘è¿›å…¥/é€€å‡ºåŠ¨ç”»
- [ ] å‘¼å¸ç¯æ•ˆæœï¼ˆå¯é€‰ï¼‰
- [ ] è¿›åº¦ç¯åŠ¨ç”»
- [ ] æç®€è®¾è®¡é£æ ¼

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

> **æ¶æ„å†³ç­–**: ä¸“æ³¨æ¨¡å¼ UI ä½œä¸º Goal æ¨¡å—çš„è§†å›¾ç»„ä»¶ï¼Œæ•°æ®æ¥è‡ª Goal èšåˆæ ¹

### UI è®¾è®¡

```
ä¸“æ³¨æ¨¡å¼å…¨å±è§†å›¾:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                      â”‚
â”‚                                                      â”‚
â”‚                                                      â”‚
â”‚                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                          â”‚
â”‚                  â–ˆâ–ˆ        â–ˆâ–ˆ                        â”‚
â”‚                â–ˆâ–ˆ   24:37   â–ˆâ–ˆ                       â”‚
â”‚                â–ˆâ–ˆ            â–ˆâ–ˆ                      â”‚
â”‚                  â–ˆâ–ˆ        â–ˆâ–ˆ                        â”‚
â”‚                    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                          â”‚
â”‚                                                      â”‚
â”‚         ç¼–å†™ STORY-033 æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£                  â”‚
â”‚                                                      â”‚
â”‚            ç›®æ ‡: å®Œæˆä¸“æ³¨æ¨¡å¼è®¾è®¡                    â”‚
â”‚                                                      â”‚
â”‚                                                      â”‚
â”‚             [æŒ‰ Esc é€€å‡ºä¸“æ³¨æ¨¡å¼]                    â”‚
â”‚                                                      â”‚
â”‚                                                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ§åˆ¶æ¡:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                      â”‚
â”‚                   [æ§åˆ¶æ¡è‡ªåŠ¨éšè—]                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  [â¸ æš‚åœ] [â­ è·³è¿‡] [ğŸ“ ç¬”è®°] [âœ• é€€å‡º]      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç»„ä»¶å®ç°

```typescript
// apps/desktop/src/renderer/views/focus/FocusModeView.tsx
import { useState, useEffect } from 'react';
import { usePomodoro } from '@/hooks/usePomodoro';

export const FocusModeView = () => {
  const { currentSession, remainingSeconds, pause, resume, skip } = usePomodoro();
  const [showControls, setShowControls] = useState(false);
  const [notes, setNotes] = useState('');
  
  // è‡ªåŠ¨éšè—é¼ æ ‡
  useEffect(() => {
    let timeout: NodeJS.Timeout;
    const handleMouseMove = () => {
      setShowControls(true);
      clearTimeout(timeout);
      timeout = setTimeout(() => setShowControls(false), 3000);
    };
    
    window.addEventListener('mousemove', handleMouseMove);
    return () => window.removeEventListener('mousemove', handleMouseMove);
  }, []);
  
  // å¿«æ·é”®
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === 'Escape') {
        exitFocusMode();
      } else if (e.key === ' ') {
        e.preventDefault();
        currentSession?.status === 'active' ? pause() : resume();
      }
    };
    
    window.addEventListener('keydown', handleKeyDown);
    return () => window.removeEventListener('keydown', handleKeyDown);
  }, [currentSession]);
  
  return (
    <div className="focus-mode-container">
      {/* å¤§å€’è®¡æ—¶å™¨ */}
      <CircularTimer
        seconds={remainingSeconds}
        total={currentSession?.duration || 1500}
      />
      
      {/* ä»»åŠ¡ä¿¡æ¯ */}
      <div className="task-info">
        <h1>{currentSession?.task?.title || 'ä¸“æ³¨ä¸­'}</h1>
        <p>{currentSession?.task?.description}</p>
      </div>
      
      {/* æ§åˆ¶æ¡ï¼ˆæ‚¬åœæ˜¾ç¤ºï¼‰ */}
      {showControls && (
        <div className="controls-bar">
          <button onClick={pause}>â¸ æš‚åœ</button>
          <button onClick={skip}>â­ è·³è¿‡</button>
          <button onClick={() => setShowNoteDialog(true)}>ğŸ“ ç¬”è®°</button>
          <button onClick={exitFocusMode}>âœ• é€€å‡º</button>
        </div>
      )}
      
      {/* å‘¼å¸ç¯èƒŒæ™¯ */}
      <div className="breathing-background" />
    </div>
  );
};

// åœ†å½¢è¿›åº¦è®¡æ—¶å™¨
const CircularTimer = ({ seconds, total }: { seconds: number; total: number }) => {
  const progress = (total - seconds) / total;
  const circumference = 2 * Math.PI * 120;  // r=120
  const offset = circumference * (1 - progress);
  
  return (
    <svg width="300" height="300" className="circular-timer">
      {/* èƒŒæ™¯åœ† */}
      <circle
        cx="150"
        cy="150"
        r="120"
        fill="none"
        stroke="#e0e0e0"
        strokeWidth="8"
      />
      {/* è¿›åº¦åœ† */}
      <circle
        cx="150"
        cy="150"
        r="120"
        fill="none"
        stroke="#4CAF50"
        strokeWidth="8"
        strokeDasharray={circumference}
        strokeDashoffset={offset}
        strokeLinecap="round"
        transform="rotate(-90 150 150)"
        style={{ transition: 'stroke-dashoffset 1s linear' }}
      />
      {/* æ—¶é—´æ–‡å­— */}
      <text
        x="150"
        y="160"
        textAnchor="middle"
        fontSize="48"
        fontWeight="bold"
        fill="#333"
      >
        {formatTime(seconds)}
      </text>
    </svg>
  );
};
```

### ç³»ç»Ÿå‹¿æ‰°é›†æˆ

```typescript
// apps/desktop/src/main/services/FocusModeService.ts
import { systemPreferences } from 'electron';

export class FocusModeService {
  private previousDNDState: boolean = false;
  
  async enterFocusMode(): Promise<void> {
    // ä¿å­˜å½“å‰å‹¿æ‰°çŠ¶æ€
    this.previousDNDState = await this.isDNDEnabled();
    
    // å¼€å¯å‹¿æ‰°
    await this.enableDND();
    
    // éšè— Dock å›¾æ ‡ï¼ˆmacOSï¼‰
    if (process.platform === 'darwin') {
      app.dock.hide();
    }
    
    // è®¾ç½®å…¨å±æˆ–æœ€å¤§åŒ–
    const win = BrowserWindow.getFocusedWindow();
    win?.setFullScreen(true);
    
    // æš‚åœéç´§æ€¥é€šçŸ¥
    notificationService.pauseNotifications();
  }
  
  async exitFocusMode(): Promise<void> {
    // æ¢å¤å‹¿æ‰°çŠ¶æ€
    if (!this.previousDNDState) {
      await this.disableDND();
    }
    
    // æ¢å¤ Dock å›¾æ ‡
    if (process.platform === 'darwin') {
      app.dock.show();
    }
    
    // é€€å‡ºå…¨å±
    const win = BrowserWindow.getFocusedWindow();
    win?.setFullScreen(false);
    
    // æ¢å¤é€šçŸ¥
    notificationService.resumeNotifications();
  }
  
  private async isDNDEnabled(): Promise<boolean> {
    if (process.platform === 'darwin') {
      return systemPreferences.getUserDefault(
        'AppleInterfaceStyle',
        'boolean'
      );
    }
    // Windows/Linux å®ç°
    return false;
  }
  
  private async enableDND(): Promise<void> {
    // å¹³å°ç‰¹å®šå®ç°
    if (process.platform === 'darwin') {
      // macOS: ä½¿ç”¨ AppleScript
      const { exec } = require('child_process');
      exec('defaults write com.apple.notificationcenterui doNotDisturb -boolean true');
    }
  }
}
```

### CSS æ ·å¼

```css
/* apps/desktop/src/renderer/styles/focus-mode.css */
.focus-mode-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  animation: fadeIn 0.5s ease-in;
}

.task-info {
  margin-top: 3rem;
  text-align: center;
  color: white;
}

.task-info h1 {
  font-size: 2.5rem;
  font-weight: 300;
  margin-bottom: 1rem;
}

.task-info p {
  font-size: 1.2rem;
  opacity: 0.8;
}

.controls-bar {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 1rem;
  padding: 1rem 2rem;
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 50px;
  animation: slideUp 0.3s ease-out;
}

.controls-bar button {
  background: transparent;
  border: none;
  color: white;
  font-size: 1.1rem;
  padding: 0.5rem 1rem;
  cursor: pointer;
  transition: all 0.2s;
}

.controls-bar button:hover {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 20px;
}

/* å‘¼å¸ç¯æ•ˆæœ */
.breathing-background {
  position: absolute;
  width: 100%;
  height: 100%;
  background: radial-gradient(
    circle,
    rgba(255, 255, 255, 0.1) 0%,
    transparent 70%
  );
  animation: breathe 4s ease-in-out infinite;
}

@keyframes breathe {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { transform: translateX(-50%) translateY(50px); opacity: 0; }
  to { transform: translateX(-50%) translateY(0); opacity: 1; }
}
```

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

```
apps/desktop/src/renderer/views/focus/
  â”œâ”€â”€ FocusModeView.tsx
  â””â”€â”€ components/
      â”œâ”€â”€ CircularTimer.tsx
      â”œâ”€â”€ ControlsBar.tsx
      â””â”€â”€ QuickNoteDialog.tsx

apps/desktop/src/renderer/styles/
  â””â”€â”€ focus-mode.css

apps/desktop/src/main/services/
  â””â”€â”€ FocusModeService.ts
```

### ä¿®æ”¹æ–‡ä»¶

```
apps/desktop/src/renderer/App.tsx
  â””â”€â”€ æ·»åŠ ä¸“æ³¨æ¨¡å¼è·¯ç”±

apps/desktop/src/main/main.ts
  â””â”€â”€ æ³¨å†Œä¸“æ³¨æ¨¡å¼ IPC å¤„ç†
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨ CSS transform è€Œé margin/padding å®ç°åŠ¨ç”»
2. **è·¨å¹³å°å…¼å®¹**ï¼šå‹¿æ‰°æ¨¡å¼åœ¨ä¸åŒå¹³å°å®ç°æ–¹å¼ä¸åŒ
3. **ç”¨æˆ·ä½“éªŒ**ï¼šç¡®ä¿å¿«æ·é”®å“åº”çµæ•ï¼Œä¸èƒ½æœ‰å»¶è¿Ÿ
4. **çŠ¶æ€æ¢å¤**ï¼šå¼‚å¸¸é€€å‡ºæ—¶æ¢å¤ç³»ç»Ÿè®¾ç½®
