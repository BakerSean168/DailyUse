# STORY-039: ä¹ æƒ¯çƒ­åŠ›å›¾

## ğŸ“‹ Story æ¦‚è¿°

**Story ID**: STORY-039  
**Epic**: EPIC-008 (Habit Tracking)  
**ä¼˜å…ˆçº§**: P2 (ä»·å€¼å¢å¼º)  
**é¢„ä¼°å·¥æ—¶**: 2 å¤©  
**çŠ¶æ€**: ğŸ“‹ Ready for Dev  
**å‰ç½®ä¾èµ–**: STORY-038 âœ… (Habit Check-in & Streak)

---

## ğŸ¯ ç”¨æˆ·æ•…äº‹

**ä½œä¸º** è¿½è¸ªä¹ æƒ¯çš„ DailyUse ç”¨æˆ·  
**æˆ‘å¸Œæœ›** çœ‹åˆ°ç±»ä¼¼ GitHub è´¡çŒ®å›¾çš„ä¹ æƒ¯çƒ­åŠ›å›¾  
**ä»¥ä¾¿äº** ç›´è§‚äº†è§£æˆ‘çš„ä¹ æƒ¯åšæŒæƒ…å†µï¼Œå‘ç°ä¹ æƒ¯æ¨¡å¼å’Œè–„å¼±ç¯èŠ‚

---

## ğŸ“‹ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶ - GitHub é£æ ¼çƒ­åŠ›å›¾

- [ ] æ˜¾ç¤ºå…¨å¹´ä¹ æƒ¯å®Œæˆæƒ…å†µï¼ˆ365å¤©ï¼‰
- [ ] æ¯ä¸ªæ ¼å­ä»£è¡¨ä¸€å¤©ï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºå®Œæˆåº¦
- [ ] å‘¨ä¸€åˆ°å‘¨æ—¥çºµå‘æ’åˆ—
- [ ] é¼ æ ‡æ‚¬åœæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ï¼ˆæ—¥æœŸã€å®Œæˆæ•°ï¼‰
- [ ] ç‚¹å‡»æ—¥æœŸæŸ¥çœ‹å½“æ—¥è¯¦æƒ…

### åŠŸèƒ½éªŒæ”¶ - è§†å›¾åˆ‡æ¢

- [ ] å¹´è§†å›¾ï¼šæ˜¾ç¤ºæ•´å¹´æ•°æ®ï¼ˆé»˜è®¤ï¼‰
- [ ] æœˆè§†å›¾ï¼šæ˜¾ç¤ºå•æœˆæ•°æ®ï¼Œæ ¼å­æ›´å¤§
- [ ] å‘¨è§†å›¾ï¼šæ˜¾ç¤ºå•å‘¨æ•°æ®ï¼Œè¯¦ç»†ä¿¡æ¯
- [ ] å¹³æ»‘åˆ‡æ¢åŠ¨ç”»

### åŠŸèƒ½éªŒæ”¶ - é¢œè‰²å¼ºåº¦

- [ ] 0% å®Œæˆï¼šç°è‰²ï¼ˆ#ebedf0ï¼‰
- [ ] 1-25% å®Œæˆï¼šæµ…ç»¿è‰²ï¼ˆ#c6e48bï¼‰
- [ ] 26-50% å®Œæˆï¼šä¸­ç»¿è‰²ï¼ˆ#7bc96fï¼‰
- [ ] 51-75% å®Œæˆï¼šæ·±ç»¿è‰²ï¼ˆ#239a3bï¼‰
- [ ] 76-100% å®Œæˆï¼šæœ€æ·±ç»¿è‰²ï¼ˆ#196127ï¼‰
- [ ] æ”¯æŒè‡ªå®šä¹‰é…è‰²æ–¹æ¡ˆ

### åŠŸèƒ½éªŒæ”¶ - å¤šä¹ æƒ¯å¯¹æ¯”

- [ ] å•ä¸ªä¹ æƒ¯çƒ­åŠ›å›¾
- [ ] å…¨éƒ¨ä¹ æƒ¯ç»¼åˆçƒ­åŠ›å›¾
- [ ] é€‰æ‹©å¤šä¸ªä¹ æƒ¯å¯¹æ¯”æ˜¾ç¤º
- [ ] ä¹ æƒ¯åˆ†ç±»ç­›é€‰

### åŠŸèƒ½éªŒæ”¶ - ç»Ÿè®¡ä¿¡æ¯

- [ ] æ˜¾ç¤ºå¹´åº¦æ€»å®Œæˆå¤©æ•°
- [ ] æ˜¾ç¤ºæœ€é•¿è¿ç»­å¤©æ•°
- [ ] æ˜¾ç¤ºå½“å‰è¿ç»­å¤©æ•°
- [ ] æ˜¾ç¤ºæœ€ä½³æœˆä»½/æœ€å·®æœˆä»½
- [ ] æ˜¾ç¤ºå®Œæˆç‡è¶‹åŠ¿

### æŠ€æœ¯éªŒæ”¶

- [ ] 365 å¤©æ•°æ®æ¸²æŸ“æ—¶é—´ < 300ms
- [ ] æ”¯æŒå“åº”å¼å¸ƒå±€ï¼ˆæ¡Œé¢/å¹³æ¿ï¼‰
- [ ] åŠ¨ç”»æµç•… 60fps
- [ ] æ•°æ®ç¼“å­˜ä¼˜åŒ–

---

## ğŸ”§ æŠ€æœ¯æ–¹æ¡ˆ

### æ•°æ®æ¨¡å‹

```typescript
// packages/domain-client/src/habit/
interface HabitHeatmapData {
  habitId: string;
  year: number;
  dailyData: DailyHeatmapCell[];
  statistics: HeatmapStatistics;
}

interface DailyHeatmapCell {
  date: Date;                    // YYYY-MM-DD
  completionCount: number;       // å®Œæˆçš„ä¹ æƒ¯æ•°
  totalHabits: number;           // å½“å¤©åº”å®Œæˆçš„ä¹ æƒ¯æ•°
  completionRate: number;        // å®Œæˆç‡ 0-1
  intensity: number;             // é¢œè‰²å¼ºåº¦ 0-4
  checkIns: HabitCheckIn[];      // è¯¦ç»†æ‰“å¡è®°å½•
}

interface HeatmapStatistics {
  totalDays: number;             // æ€»å¤©æ•°
  completedDays: number;         // å®Œæˆå¤©æ•°
  currentStreak: number;
  longestStreak: number;
  averageCompletionRate: number;
  bestMonth: { month: number; rate: number };
  worstMonth: { month: number; rate: number };
  weekdayDistribution: number[]; // 0-6 æ¯å¤©çš„å®Œæˆç‡
}

interface HeatmapConfig {
  colorScheme: ColorScheme;
  viewMode: 'year' | 'month' | 'week';
  startDate: Date;
  endDate: Date;
  showWeekLabels: boolean;
  showMonthLabels: boolean;
  cellSize: number;              // æ ¼å­å¤§å°ï¼ˆpxï¼‰
  cellGap: number;               // æ ¼å­é—´è·ï¼ˆpxï¼‰
}

type ColorScheme = {
  name: 'github' | 'blue' | 'purple' | 'orange' | 'custom';
  colors: [string, string, string, string, string]; // 5ä¸ªé¢œè‰²ç­‰çº§
};
```

### æœåŠ¡å±‚

```typescript
// packages/application-client/src/habit/services/HabitHeatmapService.ts
export class HabitHeatmapService {
  // çƒ­åŠ›å›¾æ•°æ®
  getHeatmapData(
    habitId: string | 'all',
    year: number
  ): Promise<HabitHeatmapData>;
  
  getMonthHeatmapData(
    habitId: string | 'all',
    year: number,
    month: number
  ): Promise<HabitHeatmapData>;
  
  getWeekHeatmapData(
    habitId: string | 'all',
    startDate: Date
  ): Promise<HabitHeatmapData>;
  
  // å¤šä¹ æƒ¯å¯¹æ¯”
  getComparisonHeatmap(
    habitIds: string[],
    year: number
  ): Promise<Map<string, HabitHeatmapData>>;
  
  // ç»Ÿè®¡è®¡ç®—
  calculateStatistics(
    dailyData: DailyHeatmapCell[]
  ): HeatmapStatistics;
  
  // å¼ºåº¦è®¡ç®—
  calculateIntensity(completionRate: number): number;
  // 0%: 0, 1-25%: 1, 26-50%: 2, 51-75%: 3, 76-100%: 4
  
  // é…ç½®
  getConfig(): HeatmapConfig;
  updateConfig(config: Partial<HeatmapConfig>): void;
}
```

### çƒ­åŠ›å›¾è®¡ç®—ç®—æ³•

```typescript
// ç”Ÿæˆå®Œæ•´å¹´åº¦æ•°æ®ï¼ˆå¡«å……ç¼ºå¤±æ—¥æœŸï¼‰
class HeatmapDataGenerator {
  generateYearData(
    year: number,
    checkIns: HabitCheckIn[],
    habits: Habit[]
  ): DailyHeatmapCell[] {
    const startDate = new Date(year, 0, 1);
    const endDate = new Date(year, 11, 31);
    const cells: DailyHeatmapCell[] = [];
    
    // ç”Ÿæˆ365å¤©çš„æ•°æ®
    for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
      const dateStr = this.formatDate(d);
      const dayCheckIns = checkIns.filter(c => 
        this.formatDate(c.date) === dateStr
      );
      
      // è®¡ç®—å½“å¤©åº”è¯¥å®Œæˆçš„ä¹ æƒ¯æ•°
      const totalHabits = habits.filter(h => 
        this.shouldCheckInOnDate(h, d)
      ).length;
      
      const completionCount = dayCheckIns.length;
      const completionRate = totalHabits > 0 
        ? completionCount / totalHabits 
        : 0;
      
      cells.push({
        date: new Date(d),
        completionCount,
        totalHabits,
        completionRate,
        intensity: this.calculateIntensity(completionRate),
        checkIns: dayCheckIns,
      });
    }
    
    return cells;
  }
  
  private calculateIntensity(rate: number): number {
    if (rate === 0) return 0;
    if (rate <= 0.25) return 1;
    if (rate <= 0.50) return 2;
    if (rate <= 0.75) return 3;
    return 4;
  }
  
  private shouldCheckInOnDate(habit: Habit, date: Date): boolean {
    // æ£€æŸ¥ä¹ æƒ¯æ˜¯å¦åœ¨è¯¥æ—¥æœŸéœ€è¦å®Œæˆ
    const dayOfWeek = date.getDay();
    
    if (habit.frequency.type === 'daily') {
      return true;
    }
    
    if (habit.frequency.type === 'weekly') {
      return habit.frequency.daysOfWeek?.includes(dayOfWeek) ?? false;
    }
    
    // custom é€»è¾‘...
    return false;
  }
  
  private formatDate(date: Date): string {
    return date.toISOString().split('T')[0];
  }
}
```

### UI ç»„ä»¶

#### å¹´åº¦çƒ­åŠ›å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ“Š 2025 å¹´ä¹ æƒ¯çƒ­åŠ›å›¾                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  ä¹ æƒ¯: [ å…¨éƒ¨ä¹ æƒ¯ â–¼ ]    è§†å›¾: ( â— å¹´  ( ) æœˆ  ( ) å‘¨ )    é…è‰²: [ GitHub â–¼] â”‚
â”‚                                                                              â”‚
â”‚       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec â”‚
â”‚  ä¸€  â–‘â–‘â–ˆâ–‘â–‘ â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–‘ â–‘â–‘â–ˆâ–‘â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–‘â–‘â–ˆ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â”‚
â”‚  äºŒ  â–‘â–ˆâ–ˆâ–‘â–‘ â–‘â–ˆâ–‘â–‘â–ˆ â–‘â–‘â–ˆâ–ˆâ–‘ â–ˆâ–‘â–‘â–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–ˆâ–‘â–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–‘â–‘ â–‘â–‘â–ˆâ–‘â–‘ â–ˆâ–‘â–‘â–‘â–‘â”‚
â”‚  ä¸‰  â–‘â–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–ˆâ–‘â–‘â–ˆ â–‘â–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–‘â–ˆâ”‚
â”‚  å››  â–ˆâ–‘â–ˆâ–‘â–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–‘â–ˆâ–‘â–ˆ â–‘â–‘â–ˆâ–‘â–ˆ â–‘â–‘â–ˆâ–‘â–ˆâ”‚
â”‚  äº”  â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–‘â”‚
â”‚  å…­  â–‘â–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘â”‚
â”‚  æ—¥  â–‘â–‘â–‘â–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–ˆ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–‘â–ˆâ–‘â–‘ â–‘â–‘â–ˆâ–‘â–ˆ â–‘â–‘â–ˆâ–‘â–ˆâ”‚
â”‚                                                                              â”‚
â”‚  æ‚¬åœæç¤º: ğŸ“… 2025-06-15  âœ“ 3/4 ä¹ æƒ¯å®Œæˆ  (75%)                              â”‚
â”‚                                                                              â”‚
â”‚  â–‘ 0%    â–‘ 1-25%    â–‘ 26-50%    â–ˆ 51-75%    â–ˆ 76-100%                       â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ˆ ç»Ÿè®¡æ‘˜è¦                                                                 â”‚
â”‚  â€¢ æ€»å®Œæˆå¤©æ•°: 287/365 å¤© (78.6%)                                            â”‚
â”‚  â€¢ å½“å‰è¿ç»­: 12 å¤©  ğŸ”¥                                                       â”‚
â”‚  â€¢ æœ€é•¿è¿ç»­: 45 å¤©  ğŸ†                                                       â”‚
â”‚  â€¢ æœ€ä½³æœˆä»½: 7æœˆ (93.5%)                                                     â”‚
â”‚  â€¢ æœ€å·®æœˆä»½: 2æœˆ (62.1%)                                                     â”‚
â”‚                                                                              â”‚
â”‚  ğŸ“… æ˜ŸæœŸåˆ†å¸ƒ:                                                                â”‚
â”‚  ä¸€ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 82%    äº” â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 75%                                          â”‚
â”‚  äºŒ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 85%   å…­ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 68%                                          â”‚
â”‚  ä¸‰ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 80%   æ—¥ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 81%                                          â”‚
â”‚  å›› â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 77%                                                            â”‚
â”‚                                                                              â”‚
â”‚  [ ğŸ“¥ å¯¼å‡ºå›¾ç‰‡ ]  [ ğŸ“Š è¯¦ç»†åˆ†æ ]                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æœˆè§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“Š 2025 å¹´ 6 æœˆ ä¹ æƒ¯çƒ­åŠ›å›¾                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â—„ 5æœˆ                       6æœˆ                         7æœˆ â–º              â”‚
â”‚                                                                              â”‚
â”‚      ä¸€    äºŒ    ä¸‰    å››    äº”    å…­    æ—¥                                    â”‚
â”‚                                       1â–ˆ   2â–ˆ                                â”‚
â”‚      3â–ˆ   4â–ˆ   5â–ˆ   6â–ˆ   7â–ˆ   8â–‘   9â–ˆ                                       â”‚
â”‚     10â–ˆ  11â–ˆ  12â–ˆ  13â–ˆ  14â–ˆ  15â–‘  16â–ˆ                                       â”‚
â”‚     17â–ˆ  18â–ˆ  19â–ˆ  20â–‘  21â–ˆ  22â–ˆ  23â–ˆ                                       â”‚
â”‚     24â–ˆ  25â–ˆ  26â–ˆ  27â–ˆ  28â–ˆ  29â–‘  30â–ˆ                                       â”‚
â”‚                                                                              â”‚
â”‚  æœ¬æœˆå®Œæˆ: 27/30 å¤© (90%)                                                     â”‚
â”‚  æœ€é•¿è¿ç»­: 18 å¤© (6æœˆ1æ—¥ - 6æœˆ18æ—¥)                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å¤šä¹ æƒ¯å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ“Š ä¹ æƒ¯å¯¹æ¯” - 2025å¹´                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  é€‰æ‹©ä¹ æƒ¯: [âœ“] æ™¨è·‘  [âœ“] é˜…è¯»  [âœ“] å†¥æƒ³  [ ] å­¦è‹±è¯­                          â”‚
â”‚                                                                              â”‚
â”‚  ğŸƒ æ™¨è·‘ (287å¤©, 78.6%)                                                       â”‚
â”‚  â–‘â–‘â–ˆâ–‘â–‘ â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–‘ â–‘â–‘â–ˆâ–‘â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–‘â–‘â–‘â–ˆ ...                         â”‚
â”‚                                                                              â”‚
â”‚  ğŸ“– é˜…è¯» (312å¤©, 85.5%)                                                       â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–‘â–ˆ â–ˆâ–‘â–ˆâ–ˆâ–ˆ â–ˆâ–‘â–ˆâ–ˆâ–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–‘â–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–‘â–ˆâ–‘â–ˆ ...                         â”‚
â”‚                                                                              â”‚
â”‚  ğŸ§˜ å†¥æƒ³ (198å¤©, 54.2%)                                                       â”‚
â”‚  â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–ˆ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–‘â–ˆâ–ˆâ–‘ â–‘â–‘â–‘â–‘â–‘ â–‘â–ˆâ–‘â–ˆâ–‘ â–‘â–‘â–‘â–‘â–‘ ...                         â”‚
â”‚                                                                              â”‚
â”‚  æ´å¯Ÿ:                                                                       â”‚
â”‚  â€¢ "é˜…è¯»" æ˜¯ä½ åšæŒæœ€å¥½çš„ä¹ æƒ¯ ğŸ’ª                                               â”‚
â”‚  â€¢ "å†¥æƒ³" åœ¨å‘¨æœ«å®Œæˆç‡è¾ƒä½ï¼Œå»ºè®®è°ƒæ•´æ—¶é—´                                     â”‚
â”‚  â€¢ 7-8æœˆæ˜¯ä½ çš„é«˜æ•ˆæœŸï¼Œä¿æŒï¼                                                  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ—¥æœŸè¯¦æƒ…å¼¹çª—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ğŸ“… 2025å¹´6æœˆ15æ—¥ (å‘¨æ—¥)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ“ å·²å®Œæˆ 3/4 ä¹ æƒ¯ (75%)                             â”‚
â”‚                                                      â”‚
â”‚  âœ“ ğŸƒ æ™¨è·‘ 30åˆ†é’Ÿ  - 07:23 æ‰“å¡                      â”‚
â”‚    å¤‡æ³¨: è·‘äº†5å…¬é‡Œï¼Œæ„Ÿè§‰å¾ˆå¥½                         â”‚
â”‚                                                      â”‚
â”‚  âœ“ ğŸ“– é˜…è¯» 30åˆ†é’Ÿ  - 21:15 æ‰“å¡                      â”‚
â”‚    å¤‡æ³¨: è¯»å®Œäº†ã€ŠåŸåˆ™ã€‹ç¬¬3ç«                          â”‚
â”‚                                                      â”‚
â”‚  âœ“ ğŸ’§ å– 8 æ¯æ°´  - 20:00 æ‰“å¡                        â”‚
â”‚                                                      â”‚
â”‚  âœ— ğŸ§˜ å†¥æƒ³ 10åˆ†é’Ÿ  - æœªå®Œæˆ                          â”‚
â”‚                                                      â”‚
â”‚              [ å…³é—­ ]  [ è¡¥æ‰“å¡ ]                    â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### çƒ­åŠ›å›¾ç»„ä»¶å®ç°

```typescript
// React + D3.js æˆ–çº¯ Canvas å®ç°
import React from 'react';

interface HeatmapCellProps {
  cell: DailyHeatmapCell;
  config: HeatmapConfig;
  onHover: (cell: DailyHeatmapCell) => void;
  onClick: (cell: DailyHeatmapCell) => void;
}

const HeatmapCell: React.FC<HeatmapCellProps> = ({ 
  cell, 
  config, 
  onHover, 
  onClick 
}) => {
  const color = config.colorScheme.colors[cell.intensity];
  
  return (
    <rect
      x={/* è®¡ç®—xä½ç½® */}
      y={/* è®¡ç®—yä½ç½® */}
      width={config.cellSize}
      height={config.cellSize}
      rx={2}
      fill={color}
      onMouseEnter={() => onHover(cell)}
      onClick={() => onClick(cell)}
      style={{ cursor: 'pointer' }}
    />
  );
};

// æ€§èƒ½ä¼˜åŒ–ï¼šä½¿ç”¨ Canvas æ¸²æŸ“å¤§é‡æ ¼å­
class HeatmapCanvas {
  private ctx: CanvasRenderingContext2D;
  
  render(data: DailyHeatmapCell[], config: HeatmapConfig) {
    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    
    data.forEach((cell, index) => {
      const { x, y } = this.calculatePosition(index, config);
      const color = config.colorScheme.colors[cell.intensity];
      
      this.ctx.fillStyle = color;
      this.ctx.fillRect(x, y, config.cellSize, config.cellSize);
    });
  }
  
  private calculatePosition(index: number, config: HeatmapConfig) {
    const weekIndex = Math.floor(index / 7);
    const dayIndex = index % 7;
    
    return {
      x: weekIndex * (config.cellSize + config.cellGap),
      y: dayIndex * (config.cellSize + config.cellGap),
    };
  }
}
```

### é…è‰²æ–¹æ¡ˆ

```typescript
const COLOR_SCHEMES: Record<string, ColorScheme> = {
  github: {
    name: 'github',
    colors: ['#ebedf0', '#c6e48b', '#7bc96f', '#239a3b', '#196127'],
  },
  blue: {
    name: 'blue',
    colors: ['#ebedf0', '#c0ddf9', '#73b3f3', '#3886e1', '#17459e'],
  },
  purple: {
    name: 'purple',
    colors: ['#ebedf0', '#e4c1f9', '#c77dff', '#9d4edd', '#5a189a'],
  },
  orange: {
    name: 'orange',
    colors: ['#ebedf0', '#fed9b7', '#f07167', '#d62828', '#9d0208'],
  },
};
```

---

## ğŸ“ æ–‡ä»¶å˜æ›´æ¸…å•

### æ–°å¢æ–‡ä»¶

```
packages/domain-client/src/habit/
  â”œâ”€â”€ aggregates/HabitHeatmapData.ts
  â”œâ”€â”€ value-objects/HeatmapConfig.ts
  â””â”€â”€ value-objects/DailyHeatmapCell.ts

packages/application-client/src/habit/
  â”œâ”€â”€ services/HabitHeatmapService.ts
  â””â”€â”€ utils/HeatmapDataGenerator.ts

apps/desktop/src/renderer/components/habit/
  â”œâ”€â”€ HabitHeatmapPage.tsx
  â”œâ”€â”€ HeatmapView.tsx
  â”œâ”€â”€ HeatmapCell.tsx
  â”œâ”€â”€ HeatmapLegend.tsx
  â”œâ”€â”€ HeatmapStatistics.tsx
  â”œâ”€â”€ HeatmapTooltip.tsx
  â”œâ”€â”€ HeatmapViewToggle.tsx
  â”œâ”€â”€ HabitComparisonView.tsx
  â”œâ”€â”€ DateDetailModal.tsx
  â””â”€â”€ ColorSchemeSelector.tsx

apps/desktop/src/renderer/hooks/
  â””â”€â”€ useHeatmap.ts

apps/desktop/src/renderer/utils/
  â”œâ”€â”€ heatmapCalculations.ts
  â””â”€â”€ colorSchemes.ts

apps/desktop/src/renderer/canvas/
  â””â”€â”€ HeatmapCanvas.ts (å¯é€‰ï¼Œæ€§èƒ½ä¼˜åŒ–)
```

### ä¿®æ”¹æ–‡ä»¶

```
apps/desktop/src/renderer/routes.tsx
  â””â”€â”€ æ·»åŠ çƒ­åŠ›å›¾é¡µé¢è·¯ç”±

apps/desktop/src/renderer/components/habit/HabitDetailPage.tsx
  â””â”€â”€ é›†æˆçƒ­åŠ›å›¾è§†å›¾

package.json
  â””â”€â”€ æ·»åŠ  D3.js æˆ– rechartsï¼ˆå¦‚éœ€è¦ï¼‰
```

---

## ğŸ§ª æµ‹è¯•è¦ç‚¹

### å•å…ƒæµ‹è¯•

- çƒ­åŠ›å›¾æ•°æ®ç”Ÿæˆå‡†ç¡®æ€§
- å¼ºåº¦è®¡ç®—ç®—æ³•
- ç»Ÿè®¡æ•°æ®è®¡ç®—
- ç¼ºå¤±æ—¥æœŸå¡«å……

### é›†æˆæµ‹è¯•

- å¤šä¹ æƒ¯æ•°æ®èšåˆ
- è·¨å¹´æ•°æ®æŸ¥è¯¢
- é…è‰²æ–¹æ¡ˆåˆ‡æ¢
- è§†å›¾åˆ‡æ¢

### E2E æµ‹è¯•

- æ‚¬åœæ˜¾ç¤ºè¯¦æƒ…
- ç‚¹å‡»æŸ¥çœ‹æ—¥æœŸè¯¦æƒ…
- å¯¼å‡ºçƒ­åŠ›å›¾å›¾ç‰‡
- ä¹ æƒ¯å¯¹æ¯”

### æ€§èƒ½æµ‹è¯•

- 365å¤©æ•°æ®æ¸²æŸ“æ€§èƒ½
- å¤§é‡ä¹ æƒ¯å¯¹æ¯”æ€§èƒ½
- åŠ¨ç”»æµç•…åº¦
- å†…å­˜å ç”¨

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½ä¼˜åŒ–**ï¼š365ä¸ªæ ¼å­æ¸²æŸ“è¦ä¼˜åŒ–ï¼Œè€ƒè™‘ä½¿ç”¨ Canvas æˆ–è™šæ‹Ÿæ»šåŠ¨
2. **å“åº”å¼**ï¼šä¸åŒå±å¹•å°ºå¯¸ä¸‹è‡ªåŠ¨è°ƒæ•´æ ¼å­å¤§å°å’Œå¸ƒå±€
3. **è‰²ç›²å‹å¥½**ï¼šæä¾›è‰²ç›²å‹å¥½çš„é…è‰²æ–¹æ¡ˆ
4. **æ•°æ®ç¼“å­˜**ï¼šçƒ­åŠ›å›¾æ•°æ®å¯ç¼“å­˜ï¼Œæ‰“å¡åå¢é‡æ›´æ–°
5. **æ—¶åŒºå¤„ç†**ï¼šæ—¥æœŸè¦ä½¿ç”¨æœ¬åœ°æ—¶åŒºï¼Œé¿å…è·¨æ—¶åŒºé—®é¢˜
6. **æ— éšœç¢**ï¼šçƒ­åŠ›å›¾è¦æ”¯æŒé”®ç›˜å¯¼èˆªå’Œå±å¹•é˜…è¯»å™¨
7. **å¯¼å‡ºè´¨é‡**ï¼šå¯¼å‡ºçš„å›¾ç‰‡è¦é«˜æ¸…ï¼Œé€‚åˆåˆ†äº«
8. **åŠ¨ç”»æµç•…**ï¼šè§†å›¾åˆ‡æ¢åŠ¨ç”»è¦è‡ªç„¶ï¼Œä¸å¡é¡¿

---

## ğŸš€ æœªæ¥æ‰©å±•

1. **3Dçƒ­åŠ›å›¾**ï¼šç«‹ä½“å±•ç¤ºæ›´æœ‰è§†è§‰å†²å‡»åŠ›
2. **åŠ¨ç”»å›æ”¾**ï¼šå›æ”¾ä¸€å¹´çš„ä¹ æƒ¯å˜åŒ–è¿‡ç¨‹
3. **AIæ´å¯Ÿ**ï¼šè‡ªåŠ¨åˆ†æçƒ­åŠ›å›¾ï¼Œç»™å‡ºä¹ æƒ¯å»ºè®®
4. **ç¤¾äº¤åˆ†äº«**ï¼šç”Ÿæˆç²¾ç¾çš„å¹´åº¦ä¹ æƒ¯æŠ¥å‘Šåˆ†äº«åˆ°ç¤¾äº¤å¹³å°
5. **å¯¹æ¯”åŠŸèƒ½**ï¼šä¸å»å¹´åŒæœŸå¯¹æ¯”
6. **ç›®æ ‡å åŠ **ï¼šåœ¨çƒ­åŠ›å›¾ä¸Šå åŠ ä¹ æƒ¯ç›®æ ‡çº¿
7. **ç§»åŠ¨ç«¯ä¼˜åŒ–**ï¼šæ‰‹æœºä¸Šçš„äº¤äº’ä½“éªŒä¼˜åŒ–
8. **æ‰“å°ä¼˜åŒ–**ï¼šæ”¯æŒæ‰“å°æˆæµ·æŠ¥
