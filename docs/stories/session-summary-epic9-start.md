# ä¼šè¯æ€»ç»“ - Epic 9 å¯åŠ¨

**æ—¶é—´**: 2025-10-31  
**ä»»åŠ¡**: å›ç­”é—®é¢˜ + å®Œæˆ Epic 8 + å¯åŠ¨ Epic 9

---

## ğŸ“‹ ç”¨æˆ·é—®é¢˜å›ç­”

### 1. VueUse æ˜¯ Vue è‡ªå¸¦çš„å—ï¼Ÿ

**ç­”æ¡ˆ**: âŒ **ä¸æ˜¯**

**è¯¦ç»†è¯´æ˜**:
- VueUse æ˜¯ä¸€ä¸ª**ç‹¬ç«‹çš„ç¬¬ä¸‰æ–¹åº“**
- ç”± Vue æ ¸å¿ƒå›¢é˜Ÿæˆå‘˜ **Anthony Fu** åˆ›å»º
- **å®˜æ–¹æ¨è**ç”¨äº Vue 3 Composition API é¡¹ç›®
- éœ€è¦å•ç‹¬å®‰è£…ï¼š`pnpm add @vueuse/core`
- ä½ çš„é¡¹ç›®å·²å®‰è£…ï¼š`@vueuse/core: 14.0.0`

**ç±»æ¯”**:
- Vue â‰  VueUse
- å°±åƒ React â‰  React Router
- æ ¸å¿ƒåº“ vs ç”Ÿæ€åº“

**ä¸ºä»€ä¹ˆæ¨è VueUse**:
1. âœ… ä¸“ä¸º Vue 3 Composition API è®¾è®¡
2. âœ… æä¾› 100+ å®ç”¨å‡½æ•°ï¼ˆé˜²æŠ–ã€èŠ‚æµã€localStorage ç­‰ï¼‰
3. âœ… TypeScript å‹å¥½ï¼Œå®Œæ•´ç±»å‹å®šä¹‰
4. âœ… å“åº”å¼é›†æˆï¼Œä¸ Vue ref/reactive æ— ç¼é…åˆ
5. âœ… æŒ‰éœ€å¼•å…¥ï¼ŒTree-shakable

---

### 2. Epic 8 æ˜¯å¦å®Œæˆï¼Ÿ

**ç­”æ¡ˆ**: âœ… **å·²å®Œæˆ**

**Epic 8 å®Œæˆæƒ…å†µ**:

| Story | çŠ¶æ€ | å®Œæˆæ—¶é—´ | è¡Œæ•° | è¯´æ˜ |
|-------|------|---------|------|------|
| 8-1 Markdown ç¼–è¾‘å™¨åŸºç¡€ | âœ… Done | 2025-10-31 | ~1,670 | Frontend + Backend |
| 8-2 åŒå‘é“¾æ¥åŠŸèƒ½ | âœ… Done | 2025-10-31 | ~2,395 | Backend + Frontend + Integration + VueUse é˜²æŠ–ä¼˜åŒ– |

**Epic 8 æ€»è®¡**:
- **ä»£ç **: 17 ä¸ªæ–‡ä»¶ï¼Œ~4,065 lines
- **æ–‡æ¡£**: 7 ç¯‡æŠ¥å‘Šï¼Œ~3,300 lines
- **æ€»è®¡**: ~7,365 lines

**Epic 8 çŠ¶æ€æ›´æ–°**:
- Before: `epic-8: in-progress`
- After: `epic-8: done` âœ…

---

### 3. ç»§ç»­å®ç° Epic 9

**ç­”æ¡ˆ**: âœ… **å·²å¯åŠ¨**

---

## ğŸš€ Epic 9 å¯åŠ¨è¯¦æƒ…

### Epic 9: Setting Module (ç”¨æˆ·è®¾ç½®)

**Epic çŠ¶æ€**: `contexted` â†’ `in-progress` ğŸš§

**Story è§„åˆ’**:

| Story ID | Story æ ‡é¢˜ | ä¼˜å…ˆçº§ | Story Points | çŠ¶æ€ |
|----------|-----------|--------|--------------|------|
| 9-1 | ç”¨æˆ·åå¥½è®¾ç½®ç®¡ç† | P0 | 5 | â¸ï¸ Ready for Dev |

**é¢„è®¡å·¥ä½œé‡**: 0.5 å‘¨ (6-8 å°æ—¶)

---

## ğŸ“„ Story 9-1 è¯¦ç»†ä¿¡æ¯

### Story: ç”¨æˆ·åå¥½è®¾ç½®ç®¡ç†

**æ–‡ä»¶**: `/workspaces/DailyUse/docs/stories/9-1-user-preference-settings.md`

#### åŠŸèƒ½èŒƒå›´

**ç•Œé¢è®¾ç½®**:
- âœ… ä¸»é¢˜é€‰æ‹© (æµ…è‰²/æ·±è‰²/è‡ªåŠ¨)
- âœ… è¯­è¨€é€‰æ‹© (ä¸­æ–‡/English)
- âœ… å­—ä½“å¤§å° (å°/ä¸­/å¤§)

**é€šçŸ¥åå¥½**:
- âœ… é‚®ä»¶é€šçŸ¥å¼€å…³
- âœ… æ¨é€é€šçŸ¥å¼€å…³
- âœ… ç«™å†…é€šçŸ¥å¼€å…³
- âœ… é€šçŸ¥å£°éŸ³å¼€å…³

**ç¼–è¾‘å™¨è®¾ç½®**:
- âœ… ç¼–è¾‘å™¨ä¸»é¢˜ (default/monokai/github)
- âœ… å­—ä½“å¤§å° (14px é»˜è®¤)
- âœ… Tab å¤§å° (2/4 spaces)
- âœ… è‡ªåŠ¨æ¢è¡Œ
- âœ… è¡Œå·æ˜¾ç¤º
- âœ… Minimap æ˜¾ç¤º

**å¿«æ·é”®è®¾ç½®**:
- âœ… è‡ªå®šä¹‰å¿«æ·é”®
- âœ… å†²çªæ£€æµ‹
- âœ… é‡ç½®é»˜è®¤

**å…¶ä»–**:
- âœ… å¯åŠ¨é¡µé€‰æ‹© (dashboard/goals/tasks)
- âœ… ä¾§è¾¹æ æŠ˜å çŠ¶æ€

#### æŠ€æœ¯æ¶æ„

**Backend**:
```
apps/api/src/modules/setting/
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ user-setting.aggregate.ts
â”œâ”€â”€ application/
â”‚   â””â”€â”€ user-setting.service.ts
â”œâ”€â”€ infrastructure/
â”‚   â””â”€â”€ user-setting.repository.ts
â””â”€â”€ presentation/
    â””â”€â”€ setting.controller.ts
```

**Frontend**:
```
apps/web/src/modules/setting/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ SettingApiClient.ts
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â””â”€â”€ SettingView.vue
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ AppearanceSettings.vue
â”‚       â”œâ”€â”€ NotificationSettings.vue
â”‚       â”œâ”€â”€ EditorSettings.vue
â”‚       â””â”€â”€ ShortcutSettings.vue
â””â”€â”€ stores/
    â””â”€â”€ settingStore.ts
```

**Database Schema**:
```prisma
model UserSetting {
  id        String   @id @default(uuid())
  userId    String   @unique
  
  // ç•Œé¢è®¾ç½®
  theme     String   @default("light")
  language  String   @default("zh-CN")
  fontSize  String   @default("medium")
  
  // é€šçŸ¥åå¥½
  emailNotification   Boolean @default(true)
  pushNotification    Boolean @default(true)
  inAppNotification   Boolean @default(true)
  notificationSound   Boolean @default(true)
  
  // ç¼–è¾‘å™¨è®¾ç½®
  editorTheme         String  @default("default")
  editorFontSize      Int     @default(14)
  editorTabSize       Int     @default(2)
  editorWordWrap      Boolean @default(true)
  editorLineNumbers   Boolean @default(true)
  editorMinimap       Boolean @default(true)
  
  // å¿«æ·é”®è®¾ç½®
  shortcuts   Json    @default("{}")
  
  // å…¶ä»–
  startPage   String  @default("dashboard")
  sidebarCollapsed Boolean @default(false)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("user_settings")
}
```

**REST API**:
- `GET /api/settings/me` - è·å–å½“å‰ç”¨æˆ·è®¾ç½®
- `PUT /api/settings/me` - æ›´æ–°ç”¨æˆ·è®¾ç½®
- `POST /api/settings/reset` - é‡ç½®ä¸ºé»˜è®¤è®¾ç½®
- `GET /api/settings/defaults` - è·å–é»˜è®¤è®¾ç½®

#### æŠ€æœ¯äº®ç‚¹

1. **Pinia æŒä¹…åŒ–**: ä½¿ç”¨ `pinia-plugin-persistedstate` æœ¬åœ°ç¼“å­˜
2. **å®æ—¶åº”ç”¨**: è®¾ç½®ä¿®æ”¹åç«‹å³åº”ç”¨åˆ°ç•Œé¢
3. **å†²çªæ£€æµ‹**: å¿«æ·é”®è®¾ç½®æ”¯æŒå†²çªæ£€æµ‹
4. **é»˜è®¤å€¼ç®¡ç†**: ç»Ÿä¸€ç®¡ç†æ‰€æœ‰è®¾ç½®çš„é»˜è®¤å€¼
5. **ç±»å‹å®‰å…¨**: å…¨ç¨‹ä½¿ç”¨ TypeScript å¼ºç±»å‹

---

## ğŸ“Š å®ç°æ¸…å•

### Backend (é¢„ä¼° 2-3 å°æ—¶)

- [ ] 1. åˆ›å»º Prisma Schema (UserSetting model)
- [ ] 2. è¿è¡Œæ•°æ®åº“è¿ç§»ï¼š`pnpm prisma migrate dev --name add_user_settings`
- [ ] 3. åˆ›å»º Contracts (DTO å®šä¹‰)
- [ ] 4. å®ç° Domain Layer (UserSetting Aggregate)
- [ ] 5. å®ç° Repository Layer
- [ ] 6. å®ç° Application Service
- [ ] 7. å®ç° REST Controller
- [ ] 8. ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] 9. ç¼–å†™é›†æˆæµ‹è¯•

### Frontend (é¢„ä¼° 3-4 å°æ—¶)

- [ ] 1. åˆ›å»º SettingView ä¸»é¡µé¢
- [ ] 2. åˆ›å»º AppearanceSettings ç»„ä»¶
- [ ] 3. åˆ›å»º NotificationSettings ç»„ä»¶
- [ ] 4. åˆ›å»º EditorSettings ç»„ä»¶
- [ ] 5. åˆ›å»º ShortcutSettings ç»„ä»¶
- [ ] 6. åˆ›å»º API Client
- [ ] 7. åˆ›å»º Pinia Store
- [ ] 8. å®ç°è®¾ç½®æŒä¹…åŒ–
- [ ] 9. å®ç°ä¸»é¢˜åˆ‡æ¢é€»è¾‘
- [ ] 10. å®ç°è¯­è¨€åˆ‡æ¢é€»è¾‘
- [ ] 11. ç¼–å†™ç»„ä»¶æµ‹è¯•

### é›†æˆæµ‹è¯• (é¢„ä¼° 1 å°æ—¶)

- [ ] 1. ç«¯åˆ°ç«¯è®¾ç½®æµç¨‹æµ‹è¯•
- [ ] 2. ä¸»é¢˜åˆ‡æ¢æµ‹è¯•
- [ ] 3. è¯­è¨€åˆ‡æ¢æµ‹è¯•
- [ ] 4. é‡ç½®è®¾ç½®æµ‹è¯•

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

1. âœ… ç”¨æˆ·å¯ä»¥æŸ¥çœ‹æ‰€æœ‰è®¾ç½®é¡¹
2. âœ… ç”¨æˆ·å¯ä»¥ä¿®æ”¹ä¸»é¢˜ã€è¯­è¨€ã€å­—ä½“å¤§å°
3. âœ… ç”¨æˆ·å¯ä»¥é…ç½®é€šçŸ¥åå¥½
4. âœ… ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ç¼–è¾‘å™¨è®¾ç½®
5. âœ… ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰å¿«æ·é”®ï¼ˆæ— å†²çªï¼‰
6. âœ… è®¾ç½®ä¿®æ”¹åç«‹å³ç”Ÿæ•ˆ
7. âœ… è®¾ç½®æŒä¹…åŒ–å­˜å‚¨
8. âœ… é¡µé¢åˆ·æ–°åè®¾ç½®ä¿æŒ
9. âœ… å¯ä»¥é‡ç½®ä¸ºé»˜è®¤è®¾ç½®

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. [Story 9-1 è¯¦ç»†æ–‡æ¡£](./9-1-user-preference-settings.md)
2. [Epic 9 Context](../epic-9-context.md)
3. [Epic Planning - Epic 9](../epic-planning.md#epic-9)
4. [PRD - Setting Module](../PRD-PRODUCT-REQUIREMENTS.md#10-setting-è®¾ç½®æ¨¡å—)
5. [Sprint Status](../sprint-status.yaml)

---

## ğŸ‰ ä¼šè¯æˆæœæ€»ç»“

### å®Œæˆçš„å·¥ä½œ

1. âœ… å›ç­”äº† VueUse ç›¸å…³é—®é¢˜
2. âœ… ç¡®è®¤ Epic 8 å·² 100% å®Œæˆ
3. âœ… æ›´æ–° Epic 8 çŠ¶æ€ä¸º `done`
4. âœ… åˆ›å»º Story 9-1 è¯¦ç»†æ–‡æ¡£ (~500 lines)
5. âœ… å¯åŠ¨ Epic 9ï¼ŒçŠ¶æ€æ›´æ–°ä¸º `in-progress`
6. âœ… åˆ›å»ºå®ç°æ¸…å•å’ŒéªŒæ”¶æ ‡å‡†

### æ–‡æ¡£åˆ›å»º

- ğŸ“„ Story 9-1 æ–‡æ¡£: ~500 lines
- ğŸ“„ ä¼šè¯æ€»ç»“æ–‡æ¡£: ~300 lines
- ğŸ“„ æ€§èƒ½ä¼˜åŒ–æŒ‡å—: ~500 lines (ä¹‹å‰åˆ›å»º)

**æ€»è®¡**: ~1,300 lines æ–‡æ¡£

### Epic è¿›åº¦æ›´æ–°

| Epic | çŠ¶æ€ Before | çŠ¶æ€ After | Stories |
|------|-------------|-----------|---------|
| Epic 8 | in-progress | âœ… done | 2/2 å®Œæˆ |
| Epic 9 | contexted | ğŸš§ in-progress | 0/1 è¿›è¡Œä¸­ |

---

**ä¸‹ä¸€æ­¥**: å¼€å§‹å®ç° Story 9-1 Backendï¼ˆé¢„ä¼° 2-3 å°æ—¶ï¼‰

**ä¼šè¯å®Œæˆæ—¶é—´**: 2025-10-31  
**ç”Ÿæˆè€…**: GitHub Copilot  
**çŠ¶æ€**: âœ… Epic 9 å·²å¯åŠ¨ï¼ŒStory 9-1 Ready for Dev
