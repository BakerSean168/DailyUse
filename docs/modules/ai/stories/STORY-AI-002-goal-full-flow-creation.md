# Story AI-002: AI Goal å…¨æµç¨‹åˆ›å»º + å¤šå¹³å° Provider é…ç½®

## ğŸ“‹ Story æ¦‚è¿°

| å±æ€§         | å€¼                                 |
| ------------ | ---------------------------------- |
| **Story ID** | AI-002                             |
| **ä¼˜å…ˆçº§**   | P0 (æ ¸å¿ƒåŠŸèƒ½)                      |
| **é¢„ä¼°å·¥æ—¶** | 16h                                |
| **ä¾èµ–**     | Goal æ¨¡å—ã€ç°æœ‰ AI æ¨¡å—            |
| **å½±å“èŒƒå›´** | contracts, domain-server, api, web |

### ç”¨æˆ·æ•…äº‹

> ä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›èƒ½å¤Ÿé€šè¿‡ AI æ‚¬æµ®æŒ‰é’®å¿«é€Ÿè¾“å…¥æˆ‘çš„æƒ³æ³•ï¼Œè®© AI å¸®æˆ‘ç”Ÿæˆè§„èŒƒçš„ OKR ç›®æ ‡ï¼ˆåŒ…å«å…³é”®ç»“æœï¼‰ï¼Œå¹¶åœ¨ç¡®è®¤åä¿å­˜åˆ°ç³»ç»Ÿä¸­ã€‚
>
> ä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘å¸Œæœ›èƒ½å¤Ÿé…ç½®è‡ªå·±çš„ AI æœåŠ¡æä¾›å•†ï¼ˆå¦‚ä¸ƒç‰›äº‘ã€OpenAIï¼‰ï¼ŒåŒ…æ‹¬ API Key å’Œè¯·æ±‚åœ°å€ï¼Œç³»ç»Ÿèƒ½è‡ªåŠ¨è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨ä¾›æˆ‘é€‰æ‹©ã€‚

---

## ğŸ¯ éªŒæ”¶æ ‡å‡† (Acceptance Criteria)

### AC-1: AI Provider é…ç½®åŠŸèƒ½

- [ ] ç”¨æˆ·å¯ä»¥åœ¨è®¾ç½®é¡µé¢æ·»åŠ  AI æœåŠ¡æä¾›å•†
- [ ] æ”¯æŒè¾“å…¥ï¼šåç§°ã€æœåŠ¡ç±»å‹ã€API åœ°å€ã€API Key
- [ ] ç‚¹å‡»"æµ‹è¯•è¿æ¥"åè‡ªåŠ¨è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨
- [ ] ç”¨æˆ·å¯ä»¥é€‰æ‹©é»˜è®¤æ¨¡å‹
- [ ] æ”¯æŒå¤šä¸ª Providerï¼Œå¯è®¾ç½®ä¸€ä¸ªä¸ºé»˜è®¤
- [ ] API Key åŠ å¯†å­˜å‚¨ï¼Œå‰ç«¯ä¸è¿”å›æ˜æ–‡

### AC-2: AI Goal ç”ŸæˆåŠŸèƒ½

- [ ] ç‚¹å‡» AI æ‚¬æµ®æŒ‰é’®æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡†
- [ ] ç”¨æˆ·è¾“å…¥æƒ³æ³•åï¼ŒAI ç”Ÿæˆç»“æ„åŒ–ç›®æ ‡è‰ç¨¿
- [ ] ç›®æ ‡è‰ç¨¿åŒ…å«ï¼šæ ‡é¢˜ã€æè¿°ã€åŠ¨æœºã€ç±»åˆ«ã€å»ºè®®æ—¶é—´ã€é‡è¦æ€§/ç´§æ€¥æ€§ã€æ ‡ç­¾
- [ ] ç”¨æˆ·å¯ä»¥ç¼–è¾‘ç›®æ ‡è‰ç¨¿
- [ ] ç¡®è®¤ç›®æ ‡åï¼Œè‡ªåŠ¨è¿›å…¥ KR ç”Ÿæˆé˜¶æ®µ

### AC-3: AI Key Results ç”ŸæˆåŠŸèƒ½

- [ ] åŸºäºç¡®è®¤çš„ç›®æ ‡è‡ªåŠ¨ç”Ÿæˆ 3-5 ä¸ªå…³é”®ç»“æœ
- [ ] æ¯ä¸ª KR åŒ…å«ï¼šæ ‡é¢˜ã€ç›®æ ‡å€¼ã€å•ä½ã€æƒé‡ã€èšåˆæ–¹å¼
- [ ] ç”¨æˆ·å¯ä»¥ç¼–è¾‘ã€æ·»åŠ ã€åˆ é™¤ KR
- [ ] ç¡®è®¤åä¸€é”®ä¿å­˜ç›®æ ‡å’Œæ‰€æœ‰ KR

### AC-4: æµç¨‹å®Œæ•´æ€§

- [ ] æ”¯æŒ"é‡æ–°ç”Ÿæˆ"å›åˆ°ä¸Šä¸€æ­¥
- [ ] æ”¯æŒå–æ¶ˆæ•´ä¸ªæµç¨‹
- [ ] ç”Ÿæˆè¿‡ç¨‹æ˜¾ç¤º loading çŠ¶æ€
- [ ] é”™è¯¯æ—¶æ˜¾ç¤ºå‹å¥½æç¤º

---

## ğŸ—ï¸ æŠ€æœ¯è®¾è®¡

### æ¶æ„éµå¾ª DDD åˆ†å±‚

```
packages/contracts/          â† 1. å¥‘çº¦å±‚ï¼ˆDTOã€æšä¸¾ã€æ¥å£ï¼‰
packages/domain-server/      â† 2. é¢†åŸŸå±‚ï¼ˆå®ä½“ã€é¢†åŸŸæœåŠ¡ï¼‰
apps/api/                    â† 3. åº”ç”¨å±‚ + åŸºç¡€è®¾æ–½å±‚
apps/web/                    â† 4. è¡¨ç°å±‚ï¼ˆå‰ç«¯ï¼‰
```

### æ–°å¢/ä¿®æ”¹æ–‡ä»¶æ¸…å•

#### Phase 1: Contracts å±‚

```
packages/contracts/src/modules/ai/
â”œâ”€â”€ enums.ts                              # ä¿®æ”¹ï¼šæ·»åŠ  AIProviderType
â”œâ”€â”€ aggregates/
â”‚   â””â”€â”€ AIProviderConfigClient.ts         # æ–°å¢ï¼šProvider é…ç½® DTO
â”œâ”€â”€ api-requests/
â”‚   â”œâ”€â”€ GenerateGoalRequest.ts            # æ–°å¢ï¼šç”Ÿæˆç›®æ ‡è¯·æ±‚
â”‚   â”œâ”€â”€ AIProviderConfigRequest.ts        # æ–°å¢ï¼šProvider é…ç½®è¯·æ±‚
â”‚   â””â”€â”€ index.ts                          # ä¿®æ”¹ï¼šå¯¼å‡ºæ–°å¢ç±»å‹
â”œâ”€â”€ api-responses/
â”‚   â”œâ”€â”€ GenerateGoalResponse.ts           # æ–°å¢ï¼šç”Ÿæˆç›®æ ‡å“åº”
â”‚   â””â”€â”€ index.ts                          # ä¿®æ”¹ï¼šå¯¼å‡ºæ–°å¢ç±»å‹
â””â”€â”€ index.ts                              # ä¿®æ”¹ï¼šå¯¼å‡ºæ–°å¢æ¨¡å—
```

#### Phase 2: Domain-Server å±‚

```
packages/domain-server/src/ai/
â”œâ”€â”€ aggregates/
â”‚   â””â”€â”€ AIProviderConfig.ts               # æ–°å¢ï¼šProvider é…ç½®èšåˆæ ¹
â”œâ”€â”€ repositories/
â”‚   â””â”€â”€ IAIProviderConfigRepository.ts    # æ–°å¢ï¼šä»“å‚¨æ¥å£
â”œâ”€â”€ services/
â”‚   â””â”€â”€ AIGenerationValidationService.ts  # ä¿®æ”¹ï¼šæ·»åŠ ç›®æ ‡éªŒè¯
â””â”€â”€ index.ts                              # ä¿®æ”¹ï¼šå¯¼å‡º
```

#### Phase 3: API å±‚

```
apps/api/prisma/
â””â”€â”€ schema.prisma                         # ä¿®æ”¹ï¼šæ·»åŠ  aiProviderConfig è¡¨

apps/api/src/modules/ai/
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ adapters/
â”‚   â”‚   â”œâ”€â”€ QiniuAdapter.ts               # æ–°å¢ï¼šä¸ƒç‰›äº‘é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ CustomOpenAIAdapter.ts        # æ–°å¢ï¼šè‡ªå®šä¹‰ OpenAI å…¼å®¹é€‚é…å™¨
â”‚   â”‚   â””â”€â”€ AIAdapterFactory.ts           # æ–°å¢ï¼šé€‚é…å™¨å·¥å‚
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ PrismaAIProviderConfigRepository.ts  # æ–°å¢
â”‚   â””â”€â”€ prompts/
â”‚       â””â”€â”€ goalGenerationPrompt.ts       # æ–°å¢ï¼šç›®æ ‡ç”Ÿæˆæç¤ºè¯
â”œâ”€â”€ application/services/
â”‚   â”œâ”€â”€ AIGenerationApplicationService.ts # ä¿®æ”¹ï¼šæ·»åŠ  generateGoal
â”‚   â””â”€â”€ AIProviderConfigService.ts        # æ–°å¢ï¼šProvider é…ç½®æœåŠ¡
â””â”€â”€ interface/http/
    â”œâ”€â”€ AIProviderController.ts           # æ–°å¢ï¼šProvider æ§åˆ¶å™¨
    â””â”€â”€ aiRoutes.ts                       # ä¿®æ”¹ï¼šæ·»åŠ æ–°è·¯ç”±
```

#### Phase 4: Web å‰ç«¯å±‚

```
apps/web/src/modules/ai/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ aiGenerationApiClient.ts          # ä¿®æ”¹ï¼šæ·»åŠ æ–° API
â”œâ”€â”€ presentation/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ AIGoalCreatorFab.vue          # æ–°å¢ï¼šAI æ‚¬æµ®æŒ‰é’®
â”‚   â”‚   â”œâ”€â”€ AIGoalCreatorModal.vue        # æ–°å¢ï¼šåˆ›å»ºå¯¹è¯æ¡†
â”‚   â”‚   â”œâ”€â”€ GoalDraftEditor.vue           # æ–°å¢ï¼šç›®æ ‡è‰ç¨¿ç¼–è¾‘å™¨
â”‚   â”‚   â””â”€â”€ KRDraftEditor.vue             # æ–°å¢ï¼šKR è‰ç¨¿ç¼–è¾‘å™¨
â”‚   â””â”€â”€ composables/
â”‚       â”œâ”€â”€ useAIGoalCreation.ts          # æ–°å¢ï¼šGoal åˆ›å»ºé€»è¾‘
â”‚       â””â”€â”€ useAIProviders.ts             # æ–°å¢ï¼šProvider ç®¡ç†é€»è¾‘
â””â”€â”€ stores/
    â””â”€â”€ aiProviderStore.ts                # æ–°å¢ï¼šProvider çŠ¶æ€

apps/web/src/modules/setting/
â””â”€â”€ presentation/
    â”œâ”€â”€ components/
    â”‚   â””â”€â”€ AIProviderSettings.vue        # æ–°å¢ï¼šAI è®¾ç½®ç»„ä»¶
    â””â”€â”€ views/
        â””â”€â”€ UserSettingsView.vue          # ä¿®æ”¹ï¼šæ·»åŠ  AI è®¾ç½®åŒºå—
```

---

## ğŸ“ è¯¦ç»†è®¾è®¡

### 1. Contracts å±‚è®¾è®¡

#### 1.1 æšä¸¾æ‰©å±•

```typescript
// packages/contracts/src/modules/ai/enums.ts

/** AI æœåŠ¡æä¾›å•†ç±»å‹ */
export enum AIProviderType {
  OPENAI = 'OPENAI',
  QINIU = 'QINIU',
  ANTHROPIC = 'ANTHROPIC',
  CUSTOM = 'CUSTOM',
}

/** ç”Ÿæˆä»»åŠ¡ç±»å‹ - æ–°å¢ */
export enum GenerationTaskType {
  // ... ç°æœ‰
  GOAL_GENERATION = 'GOAL_GENERATION', // æ–°å¢
}
```

#### 1.2 AIProviderConfig DTO

```typescript
// packages/contracts/src/modules/ai/aggregates/AIProviderConfigClient.ts

export interface AIProviderConfigClientDTO {
  uuid: string;
  accountUuid: string;
  name: string;
  providerType: AIProviderType;
  baseUrl: string;
  apiKeyMasked: string; // å‰ç«¯åªæ˜¾ç¤ºæ©ç  "sk-****xxxx"
  defaultModel: string | null;
  availableModels: string[]; // ç¼“å­˜çš„å¯ç”¨æ¨¡å‹åˆ—è¡¨
  isActive: boolean;
  isDefault: boolean;
  createdAt: number;
  updatedAt: number;
}

export interface AIProviderConfigServerDTO {
  uuid: string;
  accountUuid: string;
  name: string;
  providerType: AIProviderType;
  baseUrl: string;
  apiKey: string; // æœåŠ¡ç«¯ä¿ç•™å®Œæ•´ Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰
  defaultModel: string | null;
  availableModels: string[];
  isActive: boolean;
  isDefault: boolean;
  createdAt: number;
  updatedAt: number;
}
```

#### 1.3 GenerateGoal è¯·æ±‚/å“åº”

```typescript
// packages/contracts/src/modules/ai/api-requests/GenerateGoalRequest.ts

export interface GenerateGoalRequest {
  /** ç”¨æˆ·è¾“å…¥çš„åŸå§‹æƒ³æ³• */
  idea: string;
  /** å¯é€‰ï¼šç›®æ ‡ç±»åˆ« */
  category?: string;
  /** å¯é€‰ï¼šæ—¶é—´èŒƒå›´å»ºè®® */
  timeframe?: {
    startDate?: number;
    endDate?: number;
  };
  /** å¯é€‰ï¼šé¢å¤–ä¸Šä¸‹æ–‡ */
  context?: string;
  /** å¯é€‰ï¼šæŒ‡å®šä½¿ç”¨çš„ Provider UUID */
  providerUuid?: string;
}

// packages/contracts/src/modules/ai/api-responses/GenerateGoalResponse.ts

export interface GeneratedGoalDraft {
  title: string;
  description: string;
  motivation?: string;
  category?: string;
  suggestedStartDate: number;
  suggestedEndDate: number;
  importance: number; // 1-4
  urgency: number; // 1-4
  tags: string[];
  feasibilityAnalysis?: string;
}

export interface GenerateGoalResponse {
  goal: GeneratedGoalDraft;
  tokenUsage: TokenUsageServerDTO;
  generatedAt: number;
  providerUsed: string; // ä½¿ç”¨çš„ Provider åç§°
  modelUsed: string; // ä½¿ç”¨çš„æ¨¡å‹
}
```

#### 1.4 AIProviderConfig è¯·æ±‚

```typescript
// packages/contracts/src/modules/ai/api-requests/AIProviderConfigRequest.ts

export interface CreateAIProviderRequest {
  name: string;
  providerType: AIProviderType;
  baseUrl: string;
  apiKey: string;
  defaultModel?: string;
}

export interface UpdateAIProviderRequest {
  name?: string;
  baseUrl?: string;
  apiKey?: string;
  defaultModel?: string;
  isActive?: boolean;
  isDefault?: boolean;
}

export interface TestAIProviderRequest {
  providerType: AIProviderType;
  baseUrl: string;
  apiKey: string;
}

export interface TestAIProviderResponse {
  success: boolean;
  message?: string;
  models?: Array<{ id: string; name: string }>;
}
```

---

### 2. æ•°æ®åº“è®¾è®¡

```prisma
// apps/api/prisma/schema.prisma

model aiProviderConfig {
  uuid           String   @id @default(uuid())
  accountUuid    String   @map("account_uuid")
  name           String
  providerType   String   @map("provider_type")    // QINIU, OPENAI, ANTHROPIC, CUSTOM
  baseUrl        String   @map("base_url")
  apiKeyEncrypted String  @map("api_key_encrypted") // AES-256 åŠ å¯†
  defaultModel   String?  @map("default_model")
  availableModels String  @default("[]") @map("available_models") // JSON array
  isActive       Boolean  @default(true) @map("is_active")
  isDefault      Boolean  @default(false) @map("is_default")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  account        account  @relation(fields: [accountUuid], references: [uuid], onDelete: Cascade)

  @@unique([accountUuid, name])
  @@index([accountUuid])
  @@index([isDefault])
  @@map("ai_provider_configs")
}
```

---

### 3. API è®¾è®¡

#### Provider ç®¡ç† API

| æ–¹æ³•     | è·¯å¾„                                  | æè¿°                    |
| -------- | ------------------------------------- | ----------------------- |
| `POST`   | `/api/ai/providers`                   | æ·»åŠ  Provider           |
| `GET`    | `/api/ai/providers`                   | è·å–ç”¨æˆ·çš„æ‰€æœ‰ Provider |
| `GET`    | `/api/ai/providers/:uuid`             | è·å–å•ä¸ª Provider       |
| `PUT`    | `/api/ai/providers/:uuid`             | æ›´æ–° Provider           |
| `DELETE` | `/api/ai/providers/:uuid`             | åˆ é™¤ Provider           |
| `POST`   | `/api/ai/providers/test`              | æµ‹è¯•è¿æ¥ï¼ˆæ— éœ€ä¿å­˜ï¼‰    |
| `POST`   | `/api/ai/providers/:uuid/test`        | æµ‹è¯•å·²ä¿å­˜çš„ Provider   |
| `GET`    | `/api/ai/providers/:uuid/models`      | è·å–æ¨¡å‹åˆ—è¡¨            |
| `POST`   | `/api/ai/providers/:uuid/set-default` | è®¾ä¸ºé»˜è®¤                |

#### Goal ç”Ÿæˆ API

| æ–¹æ³•   | è·¯å¾„                             | æè¿°                       |
| ------ | -------------------------------- | -------------------------- |
| `POST` | `/api/ai/generate/goal`          | ç”Ÿæˆç›®æ ‡è‰ç¨¿               |
| `POST` | `/api/ai/generate/goal-with-krs` | ä¸€æ¬¡æ€§ç”Ÿæˆç›®æ ‡+KRsï¼ˆå¯é€‰ï¼‰ |

---

### 4. Prompt è®¾è®¡

```typescript
// apps/api/src/modules/ai/infrastructure/prompts/goalGenerationPrompt.ts

export const GOAL_GENERATION_PROMPT = {
  system: `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„OKRæ•™ç»ƒå’Œç›®æ ‡è§„åˆ’ä¸“å®¶ã€‚æ ¹æ®ç”¨æˆ·çš„æƒ³æ³•ï¼Œç”Ÿæˆä¸€ä¸ªè§„èŒƒã€å¯æ‰§è¡Œçš„OKRç›®æ ‡ã€‚

## è¾“å‡ºè¦æ±‚

1. **ç›®æ ‡æ ‡é¢˜**: ç®€æ´æœ‰åŠ›ï¼Œé¼“èˆäººå¿ƒï¼Œ20å­—ä»¥å†…
2. **æè¿°**: è¯¦ç»†è¯´æ˜ç›®æ ‡çš„å†…æ¶µï¼Œ100-200å­—
3. **åŠ¨æœº**: ä¸ºä»€ä¹ˆè¿™ä¸ªç›®æ ‡é‡è¦ï¼Œå¯¹ç”¨æˆ·æœ‰ä»€ä¹ˆä»·å€¼
4. **ç±»åˆ«**: work(å·¥ä½œ)/health(å¥åº·)/learning(å­¦ä¹ )/personal(ä¸ªäºº)/finance(è´¢åŠ¡)/relationship(äººé™…)
5. **æ—¶é—´å»ºè®®**: æ ¹æ®ç›®æ ‡å¤æ‚åº¦å»ºè®®åˆç†çš„èµ·æ­¢æ—¥æœŸ
6. **é‡è¦æ€§/ç´§æ€¥æ€§**: 1-4çº§è¯„ä¼°
7. **æ ‡ç­¾**: 3-5ä¸ªç›¸å…³æ ‡ç­¾
8. **å¯è¡Œæ€§åˆ†æ**: ç®€è¦åˆ†æå®ç°çš„å¯èƒ½æ€§å’ŒæŒ‘æˆ˜

## è¾“å‡ºæ ¼å¼

ä¸¥æ ¼è¿”å› JSON æ ¼å¼ï¼š
{
  "title": "ç›®æ ‡æ ‡é¢˜",
  "description": "è¯¦ç»†æè¿°",
  "motivation": "ç›®æ ‡åŠ¨æœº",
  "category": "ç±»åˆ«",
  "suggestedStartDate": "2025-01-01",
  "suggestedEndDate": "2025-03-31",
  "importance": 3,
  "urgency": 2,
  "tags": ["æ ‡ç­¾1", "æ ‡ç­¾2"],
  "feasibilityAnalysis": "å¯è¡Œæ€§åˆ†æ..."
}`,

  user: (context: {
    idea: string;
    category?: string;
    timeframe?: any;
    additionalContext?: string;
  }) => {
    let prompt = `## ç”¨æˆ·æƒ³æ³•\n${context.idea}\n`;

    if (context.category) {
      prompt += `\n## æœŸæœ›ç±»åˆ«\n${context.category}\n`;
    }

    if (context.timeframe) {
      prompt += `\n## æœŸæœ›æ—¶é—´èŒƒå›´\nå¼€å§‹: ${context.timeframe.startDate || 'ä¸é™'}\nç»“æŸ: ${context.timeframe.endDate || 'ä¸é™'}\n`;
    }

    if (context.additionalContext) {
      prompt += `\n## è¡¥å……ä¿¡æ¯\n${context.additionalContext}\n`;
    }

    prompt += `\nè¯·æ ¹æ®ä»¥ä¸Šä¿¡æ¯ç”Ÿæˆè§„èŒƒçš„OKRç›®æ ‡ã€‚`;
    return prompt;
  },
};
```

---

### 5. å‰ç«¯äº¤äº’æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AI Goal åˆ›å»ºæµç¨‹                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Step 1   â”‚    â”‚   Step 2     â”‚    â”‚   Step 3     â”‚          â”‚
â”‚  â”‚ è¾“å…¥æƒ³æ³•  â”‚ â†’ â”‚ å®¡æ ¸/ç¼–è¾‘ç›®æ ‡ â”‚ â†’ â”‚ å®¡æ ¸/ç¼–è¾‘ KRs â”‚ â†’ ä¿å­˜   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚                â”‚                    â”‚                   â”‚
â”‚       â–¼                â–¼                    â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ æ–‡æœ¬è¾“å…¥  â”‚    â”‚ è¡¨å•ç¼–è¾‘å™¨    â”‚    â”‚ KR åˆ—è¡¨ç¼–è¾‘å™¨ â”‚          â”‚
â”‚  â”‚ ç±»åˆ«é€‰æ‹©  â”‚    â”‚ - æ ‡é¢˜        â”‚    â”‚ - æ·»åŠ /åˆ é™¤   â”‚          â”‚
â”‚  â”‚ æ—¶é—´å»ºè®®  â”‚    â”‚ - æè¿°        â”‚    â”‚ - ç¼–è¾‘è¯¦æƒ…    â”‚          â”‚
â”‚  â”‚          â”‚    â”‚ - æ—¶é—´        â”‚    â”‚ - è°ƒæ•´æƒé‡    â”‚          â”‚
â”‚  â”‚ [ç”Ÿæˆ]   â”‚    â”‚ - é‡è¦æ€§/ç´§æ€¥ â”‚    â”‚              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ [ç¡®è®¤] [é‡ç”Ÿæˆ]â”‚    â”‚ [ä¿å­˜] [é‡ç”Ÿæˆ]â”‚          â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… å®æ–½è®¡åˆ’

### Sprint 1: åŸºç¡€è®¾æ–½ (4h)

| ä»»åŠ¡                             | é¢„ä¼° | äº§å‡º       |
| -------------------------------- | ---- | ---------- |
| 1.1 Contracts å±‚ - æ–°å¢æšä¸¾ã€DTO | 1h   | ç±»å‹å®šä¹‰   |
| 1.2 Prisma Model + Migration     | 0.5h | æ•°æ®åº“è¡¨   |
| 1.3 Domain-Server å®ä½“å’Œä»“å‚¨æ¥å£ | 1h   | é¢†åŸŸå±‚     |
| 1.4 API ä»“å‚¨å®ç°                 | 1.5h | åŸºç¡€è®¾æ–½å±‚ |

### Sprint 2: Provider ç®¡ç† (4h)

| ä»»åŠ¡                              | é¢„ä¼° | äº§å‡º   |
| --------------------------------- | ---- | ------ |
| 2.1 QiniuAdapter å®ç°             | 1h   | é€‚é…å™¨ |
| 2.2 AIAdapterFactory              | 0.5h | å·¥å‚   |
| 2.3 Provider Service + Controller | 1.5h | åº”ç”¨å±‚ |
| 2.4 å‰ç«¯ AI è®¾ç½®ç»„ä»¶              | 1h   | UI     |

### Sprint 3: Goal ç”Ÿæˆ (5h)

| ä»»åŠ¡                          | é¢„ä¼° | äº§å‡º   |
| ----------------------------- | ---- | ------ |
| 3.1 Goal ç”Ÿæˆ Prompt          | 0.5h | Prompt |
| 3.2 generateGoal Service æ–¹æ³• | 1h   | æœåŠ¡   |
| 3.3 API è·¯ç”± + Controller     | 0.5h | æ¥å£   |
| 3.4 å‰ç«¯ FAB + Modal          | 2h   | UI     |
| 3.5 Goal/KR Editor ç»„ä»¶       | 1h   | UI     |

### Sprint 4: é›†æˆæµ‹è¯• (3h)

| ä»»åŠ¡         | é¢„ä¼° | äº§å‡º |
| ------------ | ---- | ---- |
| 4.1 å•å…ƒæµ‹è¯• | 1h   | æµ‹è¯• |
| 4.2 é›†æˆæµ‹è¯• | 1h   | æµ‹è¯• |
| 4.3 æ–‡æ¡£æ›´æ–° | 1h   | æ–‡æ¡£ |

---

## ğŸ” å®‰å…¨è€ƒè™‘

1. **API Key åŠ å¯†**: ä½¿ç”¨ AES-256-GCM åŠ å¯†å­˜å‚¨
2. **Key ä¸è¿”å›å‰ç«¯**: GET æ¥å£è¿”å› `apiKeyMasked: "sk-****xxxx"`
3. **æƒé™éªŒè¯**: åªèƒ½è®¿é—®è‡ªå·±çš„ Provider é…ç½®
4. **Rate Limiting**: Provider API é™åˆ¶è¯·æ±‚é¢‘ç‡
5. **è¾“å…¥éªŒè¯**: éªŒè¯ baseUrl æ ¼å¼ã€apiKey éç©º

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [ä¸ƒç‰›äº‘ AI API æ–‡æ¡£](https://developer.qiniu.com/aitokenapi)
- [Vercel AI SDK](https://sdk.vercel.ai/docs)
- [ç°æœ‰ AI æ¨¡å— README](/docs/modules/ai/README.md)

---

## ğŸ“ å˜æ›´æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ       | ä½œè€… | å˜æ›´å†…å®¹ |
| ---- | ---------- | ---- | -------- |
| 1.0  | 2025-11-27 | AI   | åˆå§‹ç‰ˆæœ¬ |
