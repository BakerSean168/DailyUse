# Feature Spec: 目标模板库

> **功能编号**: GOAL-006  
> **RICE 评分**: 140 (Reach: 7, Impact: 5, Confidence: 8, Effort: 2)  
> **优先级**: P2  
> **预估时间**: 1-1.5 周  
> **状态**: Draft  
> **负责人**: TBD  
> **最后更新**: 2025-10-21

---

## 1. 概述与目标

### 背景与痛点

用户在创建目标时，往往面临以下问题：

- ❌ 不知道如何拆解目标（如何设置 KR）
- ❌ 缺少参考，导致目标设置不合理
- ❌ 重复创建相似的目标（年度健身、季度 KPI）
- ❌ 团队目标格式不统一

### 目标用户

- **主要用户**: 首次使用 OKR 的新手
- **次要用户**: 需要快速创建目标的高频用户
- **典型画像**: "我想设立健身目标，但不知道如何量化 KR"

### 价值主张

**一句话价值**: 提供预设目标模板，降低目标创建门槛，确保目标质量

**核心收益**:

- ✅ 20+ 常见目标模板（健身、学习、工作、财务等）
- ✅ 一键应用模板并自定义
- ✅ 团队共享自定义模板
- ✅ 模板使用统计和推荐

---

## 2. 用户价值与场景

### 核心场景 1: 浏览和应用模板

**场景描述**:  
用户打开模板库，选择合适的模板创建目标。

**用户故事**:

```gherkin
As a 新用户
I want 使用预设目标模板
So that 快速创建高质量目标
```

**操作流程**:

1. 用户点击"创建目标" → "从模板创建"
2. 显示模板库：

   ```
   🎯 目标模板库
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   搜索模板...  🔍

   分类筛选: [全部 ▼] [健康 ▼] [学习 ▼] [工作 ▼]

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   💪 热门模板
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   📊 年度健身计划
   └─ 减重 5kg + 每周运动 3 次 + 体脂降至 18%
   ⭐ 1,245 次使用 | 💬 "非常实用"
   [预览] [使用模板]

   📚 季度技术学习目标
   └─ 完成 2 门课程 + 实战项目 + 技术分享
   ⭐ 892 次使用
   [预览] [使用模板]

   💰 年度储蓄目标
   └─ 存款达 10 万 + 月度记账 + 减少非必要支出
   ⭐ 756 次使用
   [预览] [使用模板]

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🏢 工作效率
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   🚀 产品上线 OKR
   📈 提升团队生产力
   🎯 季度销售目标

   [查看更多...]
   ```

3. 用户点击"预览" → "年度健身计划"
4. 显示模板详情：

   ```
   📊 年度健身计划
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   描述: 通过科学训练和饮食管理，实现健康体态

   适用场景: 个人健康管理、减重增肌
   周期建议: 1 年

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🎯 Objective (可自定义)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   2025 年实现健康体态

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   📊 Key Results (可调整数值)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   KR1: 体重从 [75]kg 降至 [70]kg
   类型: 数值型 | 初始: 75 | 目标: 70 | 单位: kg

   KR2: 每周运动至少 [3] 次
   类型: 频率型 | 目标: 3次/周 | 持续: 52 周

   KR3: 体脂率从 [25]% 降至 [18]%
   类型: 数值型 | 初始: 25 | 目标: 18 | 单位: %

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   💡 成功建议
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   • 每周固定运动日（周一/三/五）
   • 记录每日饮食和体重
   • 每月拍照对比进度

   ⭐ 1,245 人使用此模板
   💬 平均完成率: 68%

   [使用此模板] [收藏] [分享]
   ```

5. 用户点击"使用此模板"
6. 进入自定义界面，预填充模板数据
7. 用户修改数值（75kg → 80kg）
8. 点击"创建目标"
9. 目标创建成功，标记为"基于模板：年度健身计划"

**预期结果**:

- 快速创建结构化目标
- 降低 OKR 学习成本
- 提高目标质量

---

### 核心场景 2: 创建自定义模板

**场景描述**:  
用户将成功的目标保存为模板，供自己或团队复用。

**用户故事**:

```gherkin
As a 团队 Leader
I want 将优秀目标保存为模板
So that 团队成员可以复用
```

**操作流程**:

1. 用户完成一个高质量目标"Q3 产品上线"
2. 打开目标详情，点击"另存为模板"
3. 弹出模板编辑器：

   ```
   💾 创建目标模板
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   模板名称: [输入模板名称...]
   默认: "Q3 产品上线"

   描述: [输入模板描述...]

   分类: [工作 ▼]
   标签: #产品 #上线 #OKR

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   📝 模板内容
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   Objective: 成功上线 [产品名称] 并获得市场认可

   KR1: DAU 达到 [目标数值]
   KR2: 用户留存率超过 [百分比]%
   KR3: NPS 评分达到 [分数]

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🔧 可变参数（用户应用时需填写）
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   • [产品名称] - 文本
   • [目标数值] - 数字
   • [百分比] - 数字 (0-100)
   • [分数] - 数字 (0-10)

   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🌐 可见范围
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ⚪ 仅自己
   🔘 团队成员（推荐）
   ⚪ 公开（所有用户）

   [创建模板] [取消]
   ```

4. 用户填写信息并选择"团队成员"
5. 点击"创建模板"
6. 模板保存成功，显示在"我的模板"列表

**预期结果**:

- 优秀目标可复用
- 团队知识沉淀
- 减少重复劳动

---

### 核心场景 3: 模板推荐

**场景描述**:  
系统根据用户历史和当前上下文，推荐合适的模板。

**用户故事**:

```gherkin
As a 用户
I want 获得智能模板推荐
So that 发现适合我的模板
```

**操作流程**:

1. 系统分析用户画像：

   ```typescript
   interface UserProfile {
     completedGoals: Goal[];        // 历史目标
     interests: string[];           // 兴趣标签
     role: 'individual' | 'team';   // 个人/团队
     currentPeriod: 'Q1' | 'Q2'...  // 当前季度
   }

   function recommendTemplates(profile: UserProfile): Template[] {
     const recommendations: Template[] = [];

     // 1. 基于历史目标类型
     const frequentCategories = getMostFrequentCategories(profile.completedGoals);
     recommendations.push(...getTemplatesByCategory(frequentCategories));

     // 2. 基于季节/时间
     if (profile.currentPeriod === 'Q1') {
       recommendations.push(getTemplate('年度规划'));
     }

     // 3. 基于团队角色
     if (profile.role === 'team') {
       recommendations.push(...getTemplatesByTag('团队协作'));
     }

     // 4. 热门模板
     recommendations.push(...getTopTemplates(10));

     return deduplicateAndRank(recommendations);
   }
   ```

2. 用户打开"创建目标"页面
3. 显示推荐模板：

   ```
   🎯 创建新目标
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   💡 为你推荐
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   📚 季度技术学习目标
   └─ 基于你过去 3 个学习类目标推荐
   [使用模板]

   🚀 产品功能迭代 OKR
   └─ 与你的团队角色匹配
   [使用模板]

   📊 年度健身计划
   └─ Q1 热门模板（1,245 次使用）
   [使用模板]

   [浏览所有模板...]  [从空白创建]
   ```

**预期结果**:

- 个性化推荐
- 提高模板发现效率
- 提升用户体验

---

### 核心场景 4: 模板评价与优化

**场景描述**:  
用户对使用的模板进行评价，系统根据反馈优化推荐。

**用户故事**:

```gherkin
As a 用户
I want 对模板进行评价
So that 帮助其他用户选择
```

**操作流程**:

1. 用户完成基于模板的目标
2. 系统弹出评价请求：

   ```
   ⭐ 模板评价
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

   你刚完成了基于 "年度健身计划" 模板的目标

   这个模板对你有帮助吗？

   ⭐⭐⭐⭐⭐ (点击评分)

   KR 设置是否合理？
   ⚪ 非常合理  ⚪ 基本合理  ⚪ 需要改进

   你的建议:
   [文本框...]

   [提交评价] [跳过]
   ```

3. 用户评分并留言："KR2 频率太高，建议改为每周 2 次"
4. 系统记录反馈，更新模板评分
5. 模板创建者收到通知，可选择更新模板

**预期结果**:

- 模板质量持续优化
- 用户参与度提升
- 社区生态建立

---

## 3. 设计要点

### 涉及字段（Contracts）

#### 新增实体：GoalTemplate（目标模板）

```typescript
export interface GoalTemplateServerDTO {
  readonly uuid: string;
  readonly name: string;
  readonly description?: string;
  readonly category: TemplateCategory;
  readonly tags: string[];

  // 模板内容
  readonly objectiveTemplate: string; // O 模板（支持占位符）
  readonly keyResultTemplates: KRTemplate[];

  // 元数据
  readonly createdBy: string;
  readonly visibility: 'private' | 'team' | 'public';
  readonly usageCount: number;
  readonly averageCompletionRate?: number;
  readonly rating?: number; // 1-5 星

  readonly createdAt: number;
  readonly updatedAt: number;
}

export interface KRTemplate {
  readonly title: string; // 支持占位符 [参数名]
  readonly type: KRType;
  readonly targetValue?: number;
  readonly unit?: string;
  readonly description?: string;
}

export enum TemplateCategory {
  HEALTH = 'health',
  LEARNING = 'learning',
  WORK = 'work',
  FINANCE = 'finance',
  PERSONAL = 'personal',
}
```

---

## 4. MVP 范围

### MVP（1 周）

- ✅ 20 个预设模板
- ✅ 模板浏览和搜索
- ✅ 应用模板创建目标
- ✅ 基础模板推荐（热门）

### Full（+0.5 周）

- ✅ 自定义模板
- ✅ 团队模板共享
- ✅ 模板评价系统
- ✅ 智能推荐

---

## 5. 验收标准（Gherkin）

```gherkin
Feature: 目标模板库

  Scenario: 应用模板创建目标
    Given 用户在模板库
    When 选择"年度健身计划"模板
    And 修改参数：体重目标 = 70kg
    And 点击"创建目标"
    Then 应创建目标，包含 3 个 KR
    And 目标应标记为"基于模板"
```

---

## 6. 成功指标

| 指标       | 目标值                  |
| ---------- | ----------------------- |
| 模板使用率 | >40% 新目标来自模板     |
| 模板创建率 | >10% 用户创建自定义模板 |
| 模板完成率 | 比空白创建高 15%        |

---

**文档状态**: ✅ Ready for PM Review  
**下一步**: 继续创建其他核心模块 P2 功能
