# Story 11-2: AI 知识文档生成

## 概述
提供 AI 辅助的知识文档生成功能，用户可以通过快捷菜单输入提示词，AI 自动生成结构化的知识文档。

## 用户故事
作为一个知识管理用户，我希望能够快速让 AI 生成某个主题的知识文档，以便我能高效地构建个人知识库。

## 验收标准

### AC1: 快捷菜单入口
- [ ] 在文件树的右键菜单中添加「🤖 AI 生成知识文档」选项
- [ ] 点击后弹出输入对话框
- [ ] 对话框包含：主题输入框、模板选择（可选）、保存路径预览

### AC2: 知识文档生成
- [ ] 用户输入提示词后，AI 生成结构化的 Markdown 文档
- [ ] 支持流式输出，实时显示生成进度
- [ ] 生成的文档自动包含 frontmatter（title, created, updated, tags）

### AC3: 文件保存
- [ ] 默认保存路径：当前仓库的 `/knowledge/{主题名}` 文件夹
- [ ] 自动创建文件夹（如果不存在）
- [ ] 生成后自动打开新文档
- [ ] 刷新文件树显示新文件

### AC4: 设置支持
- [ ] 在设置中可修改默认保存路径
- [ ] 可选择是否生成后自动打开

## UI 设计

### 右键菜单
```
┌────────────────────────┐
│  📁 新建文件夹          │
│  📄 新建笔记            │
│  ─────────────────────  │
│  🤖 AI 生成知识文档     │  ← 新增
└────────────────────────┘
```

### 生成对话框
```
┌─ AI 知识文档生成 ───────────────────────┐
│                                          │
│  请描述你想了解的知识主题：              │
│  ┌────────────────────────────────────┐  │
│  │ 详细讲讲软路由相关知识，包括常见    │  │
│  │ 软路由系统对比、硬件选型、典型      │  │
│  │ 应用场景等                          │  │
│  └────────────────────────────────────┘  │
│                                          │
│  保存位置: /knowledge/软路由             │
│                                          │
│           [ 取消 ]  [ 🚀 生成 ]          │
└──────────────────────────────────────────┘
```

### 生成进度
```
┌─ 正在生成... ───────────────────────────┐
│                                          │
│  📝 软路由知识文档                       │
│                                          │
│  ## 1. 什么是软路由                      │
│  软路由是指利用通用计算机硬件配合专业    │
│  路由软件实现的路由器解决方案...         │
│  ▌                                       │
│                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━ 60%          │
│                                          │
└──────────────────────────────────────────┘
```

## 技术实现

### 新增文件
- `apps/web/src/modules/repository/presentation/components/dialogs/AIKnowledgeGeneratorDialog.vue`

### 修改文件
- `apps/web/src/modules/repository/presentation/components/FilesPanel.vue` - 添加右键菜单项
- `apps/web/src/modules/repository/presentation/views/RepositoryView.vue` - 集成对话框

### AI Prompt 模板
```
你是一个知识整理专家。请根据用户的需求，生成一份结构化的知识文档。

要求：
1. 使用 Markdown 格式
2. 包含清晰的标题层级
3. 内容详实、条理清晰
4. 适当使用列表、表格、代码块等格式
5. 在开头添加简短概述
6. 在结尾添加总结或延伸阅读建议

用户需求：{userPrompt}
```

## 优先级
🔥 高 - 核心功能

## 预估工时
4 小时

## 依赖
- 现有的 AI 服务接口
- SSE 流式响应支持
